(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[884],{9767:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(6540),i=s(5150),n=s(4848);let r=({items:e,onDelete:t})=>(0,n.jsx)("ul",{className:"mt-4 space-y-2",children:e.map(e=>(0,n.jsxs)("li",{className:"flex justify-between items-center border p-2 rounded",children:[(0,n.jsx)("span",{children:e.name}),(0,n.jsx)("button",{onClick:()=>t(e.id),className:"text-red-500",children:"מחק"})]},e.id))}),d=()=>{let[e,t]=(0,a.useState)([]),[s,d]=(0,a.useState)(""),[l,c]=(0,a.useState)([]),[o,h]=(0,a.useState)(""),[m,p]=(0,a.useState)(!1),[u,y]=(0,a.useState)("");(0,a.useEffect)(()=>{b(),x()},[]);let b=async()=>{try{let e=await (0,i.t9)("LessonTypes");t(e)}catch(e){w(e)}},x=async()=>{try{let e=await (0,i.t9)("Memberships");c(e)}catch(e){w(e)}},w=e=>{console.error(e),y("אירעה שגיאה, נסו שוב מאוחר יותר.")},g=async()=>{if(!s.trim()){y("שם סוג שיעור אינו יכול להיות ריק.");return}p(!0);try{let a=await (0,i.tI)("LessonTypes",{name:s.trim()});t([...e,a]),d("")}catch(e){w(e)}finally{p(!1)}},N=async()=>{if(!o.trim()){y("שם מנוי אינו יכול להיות ריק.");return}p(!0);try{let e=await (0,i.tI)("Memberships",{name:o.trim()});c([...l,e]),h("")}catch(e){w(e)}finally{p(!1)}},f=async s=>{p(!0);try{await (0,i.Nn)("LessonTypes",s),t(e.filter(e=>e.id!==s))}catch(e){w(e)}finally{p(!1)}},j=async e=>{p(!0);try{await (0,i.Nn)("Memberships",e),c(l.filter(t=>t.id!==e))}catch(e){w(e)}finally{p(!1)}};return(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"ניהול סוגי שיעורים ומנויים"}),u&&(0,n.jsx)("div",{className:"bg-red-100 text-red-700 p-4 rounded-lg mb-4",children:u}),(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4",children:"ניהול סוגי שיעורים"}),(0,n.jsx)("input",{type:"text",value:s,onChange:e=>d(e.target.value),placeholder:"הוסף סוג שיעור חדש",className:"p-2 border rounded w-full"}),(0,n.jsx)("button",{onClick:g,disabled:m||!s.trim(),className:`bg-blue-500 text-white px-4 py-2 rounded mt-2 ${m?"opacity-50":""}`,children:m?"מוסיף...":"הוסף סוג שיעור"}),(0,n.jsx)(r,{items:e,onDelete:f})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4",children:"ניהול מנויים"}),(0,n.jsx)("input",{type:"text",value:o,onChange:e=>h(e.target.value),placeholder:"הוסף מנוי חדש",className:"p-2 border rounded w-full"}),(0,n.jsx)("button",{onClick:N,disabled:m||!o.trim(),className:`bg-green-500 text-white px-4 py-2 rounded mt-2 ${m?"opacity-50":""}`,children:m?"מוסיף...":"הוסף מנוי"}),(0,n.jsx)(r,{items:l,onDelete:j})]})]})}},5150:(e,t,s)=>{"use strict";s.d(t,{Nn:()=>d,R0:()=>c,Ry:()=>o,gw:()=>p,hG:()=>u,hU:()=>h,nu:()=>m,t9:()=>n,tI:()=>r,yo:()=>l});var a=s(6430),i=s(2942);let n=async e=>(await (0,a.GG)((0,a.rJ)(i.db,e))).docs.map(e=>({id:e.id,...e.data()})),r=async(e,t)=>({id:(await (0,a.gS)((0,a.rJ)(i.db,e),t)).id,...t}),d=async(e,t)=>{await (0,a.kd)((0,a.H9)(i.db,e,t))},l=async()=>(await (0,a.GG)((0,a.rJ)(i.db,"Lessons"))).docs.map(e=>({id:e.id,...e.data()})),c=async e=>{let t=(0,a.H9)(i.db,"Users",e),s=await (0,a.x7)(t);return s.exists()&&s.data().registeredLessons||[]},o=async(e,t,s)=>{let n=(0,a.H9)(i.db,"Lessons",e),r=(0,a.H9)(i.db,"Users",t.phone),d=s?{waitingList:(0,a.hq)(t.phone),registeredParticipants:(t.registeredParticipants||0)+1}:{waitingList:(0,a.C3)(t.phone),registeredParticipants:Math.max((t.registeredParticipants||0)-1,0)},l=s?{registeredLessons:(0,a.hq)({id:e,date:new Date().toISOString(),type:"Lesson Type"})}:{registeredLessons:(0,a.C3)({id:e,date:new Date().toISOString()})};await (0,a.mZ)(n,d),await (0,a.mZ)(r,l)},h=async()=>(await (0,a.GG)((0,a.rJ)(i.db,"Users"))).docs.map(e=>({id:e.id,...e.data()})),m=async e=>{let t=(0,a.H9)(i.db,"Users",e.phone);await (0,a.BN)(t,e)},p=async(e,t)=>{let s=(0,a.H9)(i.db,"Users",e);await (0,a.mZ)(s,t)},u=async e=>{let t=(0,a.H9)(i.db,"Users",e);await (0,a.kd)(t)}},8174:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/ManagerPage",function(){return s(9767)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(8174)),_N_E=e.O()}]);