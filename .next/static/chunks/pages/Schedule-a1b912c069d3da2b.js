(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[991],{3562:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(6540),i=a(9416),r=a(5150),d=a(4848);let n=e=>{let t=new Date(e);return new Intl.DateTimeFormat("he-IL",{weekday:"long",day:"2-digit",month:"2-digit",year:"numeric"}).format(t)},c=({lesson:e,isRegistered:t,onRegister:a,onCancel:s})=>{let i=n(e.date);return(0,d.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-4 border border-gray-200 flex flex-col",children:[(0,d.jsx)("div",{className:"text-lg font-semibold text-gray-800",children:i}),(0,d.jsxs)("div",{className:"text-lg font-semibold text-gray-800",children:[e.type," עם ",e.instructor]}),(0,d.jsxs)("div",{className:"text-gray-600 mt-1",children:["שעה: ",e.time]}),(0,d.jsxs)("div",{className:"text-gray-600 mt-1",children:["משתתפים מקסימליים: ",e.maxParticipants]}),(0,d.jsxs)("div",{className:"text-gray-600 mt-1",children:["משתתפים רשומים: ",e.registeredParticipants]}),(0,d.jsxs)("div",{className:"text-gray-600 mt-1",children:["מקומות פנויים: ",e.maxParticipants-e.registeredParticipants]}),t?(0,d.jsx)("button",{onClick:()=>s(e),className:"mt-4 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600",children:"בטל הרשמה"}):(0,d.jsx)("button",{onClick:()=>a(e),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"הירשם לשיעור"})]})};var l=a(2409);let o=()=>{let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(!0),[o,m]=(0,s.useState)(""),{userData:g}=(0,i.J)();(0,s.useEffect)(()=>{x()},[]);let x=async()=>{try{let e=await (0,r.yo)(),a=new Date,s=e.map(e=>({...e,isActive:new Date(`${e.date} ${e.time}`)>=a}));t(s.filter(e=>e.isActive))}catch(e){m("אירעה שגיאה בטעינת לוח השיעורים")}finally{n(!1)}},h=async e=>{try{await (0,r.Ry)(e.id,g,!0),x()}catch(e){m("אירעה שגיאה בהרשמה לשיעור")}},y=async e=>{try{await (0,r.Ry)(e.id,g,!1),x()}catch(e){m("אירעה שגיאה בביטול ההרשמה לשיעור")}};return(0,d.jsxs)("div",{className:"container mx-auto p-4",children:[(0,d.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"לוח שיעורים"}),o&&(0,d.jsx)(l.A,{message:o}),a?(0,d.jsx)("div",{className:"text-center text-gray-500",children:"טוען..."}):e.map(e=>(0,d.jsx)(c,{lesson:e,isRegistered:e.waitingList.includes(g.phone),onRegister:h,onCancel:y},e.id))]})}},2409:(e,t,a)=>{"use strict";a.d(t,{A:()=>i}),a(6540);var s=a(4848);let i=({message:e})=>(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:(0,s.jsx)("span",{className:"block sm:inline",children:e})})},5150:(e,t,a)=>{"use strict";a.d(t,{Nn:()=>n,R0:()=>l,Ry:()=>o,gw:()=>x,hG:()=>h,hU:()=>m,nu:()=>g,t9:()=>r,tI:()=>d,yo:()=>c});var s=a(6430),i=a(2942);let r=async e=>(await (0,s.GG)((0,s.rJ)(i.db,e))).docs.map(e=>({id:e.id,...e.data()})),d=async(e,t)=>({id:(await (0,s.gS)((0,s.rJ)(i.db,e),t)).id,...t}),n=async(e,t)=>{await (0,s.kd)((0,s.H9)(i.db,e,t))},c=async()=>(await (0,s.GG)((0,s.rJ)(i.db,"Lessons"))).docs.map(e=>({id:e.id,...e.data()})),l=async e=>{let t=(0,s.H9)(i.db,"Users",e),a=await (0,s.x7)(t);return a.exists()&&a.data().registeredLessons||[]},o=async(e,t,a)=>{let r=(0,s.H9)(i.db,"Lessons",e),d=(0,s.H9)(i.db,"Users",t.phone),n=a?{waitingList:(0,s.hq)(t.phone),registeredParticipants:(t.registeredParticipants||0)+1}:{waitingList:(0,s.C3)(t.phone),registeredParticipants:Math.max((t.registeredParticipants||0)-1,0)},c=a?{registeredLessons:(0,s.hq)({id:e,date:new Date().toISOString(),type:"Lesson Type"})}:{registeredLessons:(0,s.C3)({id:e,date:new Date().toISOString()})};await (0,s.mZ)(r,n),await (0,s.mZ)(d,c)},m=async()=>(await (0,s.GG)((0,s.rJ)(i.db,"Users"))).docs.map(e=>({id:e.id,...e.data()})),g=async e=>{let t=(0,s.H9)(i.db,"Users",e.phone);await (0,s.BN)(t,e)},x=async(e,t)=>{let a=(0,s.H9)(i.db,"Users",e);await (0,s.mZ)(a,t)},h=async e=>{let t=(0,s.H9)(i.db,"Users",e);await (0,s.kd)(t)}},8006:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/Schedule",function(){return a(3562)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(8006)),_N_E=e.O()}]);