(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[163],{2646:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var r=t(6540),l=t(4848),a=t(7836);let d=e=>e.split(/(\\|\/)/).pop(),n=({passed:e,failed:s,total:t})=>(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[(0,l.jsx)("div",{className:"text-lg font-bold",children:t}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:'סה"כ בדיקות'})]}),(0,l.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[(0,l.jsx)("div",{className:"text-lg font-bold text-green-700",children:e}),(0,l.jsx)("div",{className:"text-sm text-green-600",children:"עברו"})]}),(0,l.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg text-center",children:[(0,l.jsx)("div",{className:"text-lg font-bold text-red-700",children:s}),(0,l.jsx)("div",{className:"text-sm text-red-600",children:"נכשלו"})]})]}),i=({suite:e})=>{let s="passed"===e.status;return(0,l.jsxs)("div",{className:"border rounded-lg p-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,l.jsx)("h3",{className:"font-bold",children:d(e.name)}),(0,l.jsx)("span",{className:`px-2 py-1 text-sm rounded-full ${s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s?"עבר":"נכשל"})]}),e.assertionResults?.map((e,s)=>l.jsxs("div",{className:`border-l-4 pl-3 py-2 mb-2 ${"passed"===e.status?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`,children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${"passed"===e.status?"bg-green-500":"bg-red-500"}`}),l.jsx("span",{children:e.title})]}),"failed"===e.status&&e.failureMessages?.map((e,s)=>l.jsx("div",{className:"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded",children:e.split("\n")[0]},s))]},s))]})},c=()=>{let[e,s]=(0,r.useState)(null),[t,d]=(0,r.useState)(!1),[c,o]=(0,r.useState)(null);a.env.REACT_APP_API_URL;let x=async()=>{d(!0),o(null),s(null);try{let e;let t=await fetch("api/tests/run-tests",{method:"POST",headers:{"Content-Type":"application/json"}}),r=await t.text();try{e=r?JSON.parse(r):{}}catch(e){throw Error("Invalid JSON response from server")}if(!t.ok)throw Error(e.details||e.error||"Server error occurred");console.log("Received test results:",e),s(e)}catch(e){console.error("Test run error:",e),o(`Error running tests: ${e.message}`)}finally{d(!1)}};return(0,l.jsxs)("div",{className:"relative min-h-screen",children:[(0,l.jsx)("div",{className:"sticky top-0 bg-white shadow-md z-50 p-4 border-b",children:(0,l.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"ניהול בדיקות (Jest)"}),(0,l.jsx)("button",{onClick:x,disabled:t,className:`px-4 py-2 rounded-lg ${t?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"} text-white transition-colors`,children:t?"מריץ בדיקות...":"הרץ בדיקות"})]})}),(0,l.jsxs)("div",{className:"container mx-auto p-4",children:[t&&(0,l.jsxs)("div",{className:"flex justify-center items-center p-8",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),(0,l.jsx)("span",{className:"mr-3",children:"טוען בדיקות..."})]}),c&&(0,l.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6",children:(0,l.jsx)("div",{className:"flex",children:(0,l.jsxs)("div",{className:"mr-3",children:[(0,l.jsx)("p",{className:"font-bold",children:"שגיאה בהרצת הבדיקות"}),(0,l.jsx)("p",{className:"text-sm",children:c})]})})}),!t&&!c&&e&&(0,l.jsxs)("div",{children:[(0,l.jsx)(n,{...e?{total:e.numTotalTests||0,passed:e.numPassedTests||0,failed:e.numFailedTests||0}:{total:0,passed:0,failed:0}}),(0,l.jsx)("div",{className:"space-y-4",children:e.testResults?.map((e,s)=>l.jsx(i,{suite:e},s))})]}),!t&&!c&&!e&&(0,l.jsx)("div",{className:"text-center text-gray-500 p-8",children:(0,l.jsx)("p",{className:"text-lg",children:'לחץ על "הרץ בדיקות" כדי להתחיל'})})]})]})}},6804:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/TestsScreen",function(){return t(2646)}])}},e=>{var s=s=>e(e.s=s);e.O(0,[636,593,792],()=>s(6804)),_N_E=e.O()}]);