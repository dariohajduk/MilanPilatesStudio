"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295],{9295:(e,s,t)=>{t.r(s),t.d(s,{default:()=>p});var l=t(6540);t(5338);var a=t(9416),r=t(996),n=t(5984),i=t(3562),d=t(4849),c=t(8966),x=t(8320),o=t(155),m=t(8916),h=t(4848);let g=({setCurrentScreen:e,currentScreen:s,handleLogout:t})=>{let{logoUrl:r}=(0,m.x)(),{userData:n}=(0,a.J)(),[i,d]=(0,l.useState)(!1),c=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=e=>{c.current&&!c.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let x=[{id:"home",label:"דף הבית",icon:"\uD83C\uDFE0"},{id:"schedule",label:"לוח שיעורים",icon:"\uD83D\uDCC5"},{id:"profile",label:"פרופיל",icon:"\uD83D\uDC64"}];n?.isAdmin&&x.push({id:"admin",label:"ניהול",icon:"⚙️"});let o=s=>{e(s),d(!1)};return(0,h.jsx)("nav",{className:"bg-white shadow-sm",children:(0,h.jsx)("div",{className:"max-w-7xl mx-auto px-4",children:(0,h.jsxs)("div",{className:"flex justify-between items-center h-25",children:[(0,h.jsxs)("div",{className:"flex-shrink-0 flex items-center",children:[(0,h.jsx)("img",{src:r,className:"w-32 h-32 object-contain",alt:"Milan Pilates"}),(0,h.jsx)("span",{className:"mr-2 text-lg font-semibold text-gray-900",children:"Milan Pilates"})]}),(0,h.jsxs)("div",{className:"relative",ref:c,children:[(0,h.jsxs)("button",{onClick:()=>d(!i),className:"flex items-center px-4 py-2 rounded-md text-gray-600 hover:bg-gray-50 focus:outline-none",children:[(0,h.jsx)("span",{className:"text-xl",children:i?"✕":"☰"}),(0,h.jsx)("span",{className:"mr-2 text-sm font-medium",children:"תפריט"})]}),i&&(0,h.jsx)("div",{className:"absolute left-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50",children:(0,h.jsxs)("div",{className:"py-1",children:[x.map(e=>(0,h.jsxs)("button",{onClick:()=>o(e.id),className:`w-full text-right flex items-center px-4 py-2 text-sm
                        ${s===e.id?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50"}`,children:[(0,h.jsx)("span",{className:"ml-2",children:e.icon}),e.label]},e.id)),(0,h.jsx)("div",{className:"border-t border-gray-100"}),(0,h.jsxs)("button",{onClick:()=>{t(),d(!1)},className:"w-full text-right flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[(0,h.jsx)("span",{className:"ml-2",children:"\uD83D\uDEAA"}),"התנתקות"]})]})})]})]})})})},u=()=>{let[e,s]=(0,l.useState)("login"),{isLoggedIn:t,userData:m,logout:u}=(0,a.J)(),[p,j]=(0,l.useState)(!1),[b,y]=(0,l.useState)([]),f={home:(0,h.jsx)(n.default,{user:m,lessons:m?.registeredLessons||[]}),schedule:(0,h.jsx)(i.default,{}),profile:(0,h.jsx)(d.default,{}),admin:m?.isAdmin?(0,h.jsx)(c.default,{setCurrentScreen:s}):null,lessons:m?.isAdmin?(0,h.jsx)(o.default,{}):null,users:m?.isAdmin?(0,h.jsx)(x.default,{registeredUsers:b,addUser:e=>{y([...b,e])},deleteUser:e=>{y(b.filter(s=>s.phone!==e))}}):null,settings:m?.isAdmin?(0,h.jsx)(c.default,{setCurrentScreen:s,activeTab:"settings"}):null};return(0,l.useEffect)(()=>{console.log("המסך הנוכחי:",e),console.log("isLoggedIn:",t),console.log("userData:",m)},[e,t,m]),(0,h.jsxs)("div",{className:"relative min-h-screen bg-gray-100",dir:"rtl",children:[t&&(0,h.jsx)(g,{setCurrentScreen:s,currentScreen:e,handleLogout:u,userData:m,menuOpen:p,setMenuOpen:j}),p&&t&&(0,h.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-75 z-50 md:hidden",children:(0,h.jsxs)("div",{className:"fixed inset-y-0 right-0 w-64 bg-white shadow-lg p-4",children:[(0,h.jsx)("button",{onClick:()=>j(!1),className:"absolute top-4 right-4 text-gray-800 text-xl",children:"✕"}),(0,h.jsxs)("div",{className:"mt-12 space-y-4",children:[(0,h.jsx)("button",{onClick:()=>{s("home"),j(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg",children:"דף הבית"}),(0,h.jsx)("button",{onClick:()=>{s("schedule"),j(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg",children:"לוח שיעורים"}),(0,h.jsx)("button",{onClick:()=>{s("profile"),j(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg",children:"פרופיל"}),m?.isAdmin&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("button",{onClick:()=>{s("admin"),j(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg",children:"ניהול"}),(0,h.jsx)("button",{onClick:()=>{s("users"),j(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg",children:"ניהול משתמשים"}),(0,h.jsx)("button",{onClick:()=>{s("lessons"),j(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg",children:"ניהול שיעורים"}),(0,h.jsx)("button",{onClick:()=>{s("settings"),j(!1)},className:"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg",children:"הגדרות"})]}),(0,h.jsx)("button",{onClick:u,className:"w-full text-right px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg",children:"התנתק"})]})]})}),(0,h.jsx)("main",{className:"container mx-auto p-4",children:t?f[e]||(0,h.jsx)(n.default,{}):(0,h.jsx)(r.default,{setCurrentScreen:s})})]})},p=()=>(0,h.jsx)(a.v,{children:(0,h.jsx)(u,{})})},5984:(e,s,t)=>{t.r(s),t.d(s,{default:()=>x}),t(6540);var l=t(9416),a=t(8916),r=t(4848);let n=({title:e,children:s})=>(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:e}),s]}),i=({lesson:e})=>(0,r.jsxs)("li",{className:"flex flex-col p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("span",{className:"font-bold text-gray-800",children:["שם השיעור: ",e.title]}),(0,r.jsxs)("span",{className:"text-gray-600",children:["סוג השיעור: ",e.type||"לא מוגדר"]}),(0,r.jsxs)("span",{className:"text-gray-600",children:["תאריך: ",new Date(e.date).toLocaleDateString("he-IL")]}),(0,r.jsxs)("span",{className:"text-gray-600",children:["שעה: ",e.time]})]}),d=({label:e,value:s})=>(0,r.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)("span",{className:"text-gray-600",children:e}),(0,r.jsx)("span",{className:"font-semibold",children:s})]}),c=({label:e,value:s})=>(0,r.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("span",{className:"text-gray-600",children:[e,": "]}),(0,r.jsx)("span",{className:"font-semibold",children:s})]}),x=()=>{let{userData:e}=(0,l.J)(),{logoUrl:s}=(0,a.x)(),t=new Date;t.setHours(0,0,0,0);let x=new Date;x.setDate(t.getDate()+(7-t.getDay()));let o=e?.registeredLessons?.filter(e=>{let s=new Date(e.date);return s>=t&&s<=x})||[],m=e?.registeredLessons?.filter(e=>new Date(e.date)<t).length||0,h=(s=>{let l=e?.joinDate?new Date(e.joinDate):t,a=Math.ceil((t-l)/6048e5);return(s/(a>0?a:1)).toFixed(2)})(m);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center bg-white rounded-lg p-8 shadow-sm",children:[(0,r.jsx)("div",{className:"logo-container",children:(0,r.jsx)("img",{src:s||"/default-logo.png",alt:"Studio Logo",className:"logo"})}),(0,r.jsxs)("h1",{className:"text-2xl font-bold text-gray-800",children:[(()=>{let e=new Date().getHours();return e<12?"בוקר טוב":e<17?"צהריים טובים":e<21?"ערב טוב":"לילה טוב"})(),", ",e?.name||"אורח"]}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"ברוכים הבאים למערכת השיעורים של Milan Pilates"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsx)(n,{title:"השיעורים הקרובים שלך",children:o.length>0?(0,r.jsx)("ul",{className:"space-y-3",children:o.map((e,s)=>(0,r.jsx)(i,{lesson:e},s))}):(0,r.jsx)("p",{className:"text-gray-500 text-center py-4",children:"אין שיעורים קרובים השבוע"})}),(0,r.jsxs)(n,{title:"סטטיסטיקות",children:[(0,r.jsx)(d,{label:"שיעורים שהשתתפת",value:m}),(0,r.jsx)(d,{label:"כמות שיעורים עתידיים",value:o.length}),(0,r.jsx)(d,{label:"ממוצע שיעורים בשבוע",value:h})]}),(0,r.jsxs)(n,{title:"פרטי מנוי",children:[(0,r.jsx)(c,{label:"סוג מנוי",value:e?.membershipType||"רגיל"}),(0,r.jsx)(c,{label:"תאריך הצטרפות",value:e?.joinDate||"לא זמין"})]})]})]})}},996:(e,s,t)=>{t.r(s),t.d(s,{default:()=>x});var l=t(6540),a=t(6430),r=t(2942),n=t(9416),i=t(8916);let d=e=>/^05\d{8}$/.test(e);var c=t(4848);let x=({setCurrentScreen:e})=>{let[s,t]=(0,l.useState)(""),[x,o]=(0,l.useState)(!1),[m,h]=(0,l.useState)(""),{updateUserData:g}=(0,n.J)(),{logoUrl:u,loading:p}=(0,i.x)();if(console.log("Logo URL:",u),p)return(0,c.jsx)("div",{children:"Loading..."});let j={phone:"0500000000",name:"מנהל מערכת",isAdmin:!0},b=async t=>{t.preventDefault(),o(!0);try{if(!d(s))throw Error("נא להזין מספר טלפון תקין בפורמט: 05XXXXXXXX");if(s===j.phone){g(j),e("admin"),o(!1);return}let t=(0,a.H9)(r.db,"Users",s),l=await (0,a.x7)(t);if(l.exists()){let t={phone:s,...l.data(),isAdmin:!1,registeredLessons:l.data().registeredLessons||[],completedLessons:l.data().completedLessons||0,membershipType:l.data().membershipType||"רגיל",joinDate:l.data().joinDate||new Date().toISOString()};g(t),e("home")}else if(s===j.phone)e("admin");else throw Error("מספר טלפון לא נמצא במערכת")}catch(e){console.error("Login error:",e),h(e.message)}finally{o(!1)}};return(0,c.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-green-50 flex items-center justify-center p-4",children:(0,c.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-white/90 backdrop-blur-sm rounded-xl p-8 shadow-lg",children:[(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsxs)("div",{className:"flex flex-col items-center mb-6",children:[(0,c.jsx)("img",{src:u||"/fallback-logo.png",alt:"Milan Pilates Logo",className:"w-32 h-32 object-contain mb-4"}),(0,c.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-blue-400 text-transparent bg-clip-text",children:"Milan Pilates"}),(0,c.jsx)("span",{className:"text-sm text-gray-500 mt-1",children:"By Isakov Team"})]}),(0,c.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:"ברוכים הבאים"}),(0,c.jsx)("p",{className:"mt-2 text-gray-600",children:"התחברו כדי להירשם לשיעורים ולנהל את האימונים שלכם"})]}),(0,c.jsxs)("form",{onSubmit:b,className:"mt-8 space-y-6",children:[m&&(0,c.jsx)("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg text-sm text-center",children:m}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"מספר טלפון"}),(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)("span",{className:"absolute right-3 top-3 text-gray-400",children:"\uD83D\uDCF1"}),(0,c.jsx)("input",{id:"phone",type:"tel",value:s,onChange:e=>{t(e.target.value.replace(/[^0-9]/g,"")),m&&h("")},disabled:x,className:"w-full pr-10 p-3 border border-gray-300 rounded-lg  focus:ring-2 focus:ring-blue-200 focus:border-blue-400  outline-none transition-all disabled:opacity-50",placeholder:"הזינו מספר טלפון",dir:"ltr",maxLength:10})]}),(0,c.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"יש להזין מספר בפורמט: 05XXXXXXXX"})]}),(0,c.jsx)("button",{type:"submit",disabled:x||!s,className:"w-full p-3 bg-gradient-to-r from-blue-600 to-blue-500  text-white rounded-lg font-medium transition-all hover:from-blue-700 hover:to-blue-600  focus:outline-none focus:ring-2 focus:ring-blue-300 disabled:opacity-50",children:x?(0,c.jsxs)("div",{className:"flex items-center justify-center",children:[(0,c.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,c.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,c.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"טוען..."]}):"התחבר"})]})]})})}},4849:(e,s,t)=>{t.r(s),t.d(s,{default:()=>c});var l=t(6540),a=t(9416),r=t(5150),n=t(4848);let i=({lesson:e})=>(0,n.jsx)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"font-bold text-lg",children:e.title||`${e.type} - ${e.instructor}`}),(0,n.jsxs)("p",{className:"text-gray-600",children:["מדריך: ",e.instructor]}),(0,n.jsxs)("p",{className:"text-gray-600",children:["תאריך: ",e.date]}),(0,n.jsxs)("p",{className:"text-gray-600",children:["שעה: ",e.time]})]})});var d=t(2409);let c=()=>{let{userData:e}=(0,a.J)(),[s,t]=(0,l.useState)([]),[c,x]=(0,l.useState)(!0),[o,m]=(0,l.useState)(""),h=new Date,g=(0,l.useCallback)(async()=>{try{let s=(await (0,r.R0)(e.phone)).filter(e=>new Date(e.date)>h);t(s)}catch(e){console.error("Error fetching registered lessons:",e),m("אירעה שגיאה בטעינת השיעורים")}finally{x(!1)}},[e,h]);return((0,l.useEffect)(()=>{e?.phone&&g()},[g]),e)?(0,n.jsxs)("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[o&&(0,n.jsx)(d.A,{message:o}),(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"פרופיל משתמש"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[(0,n.jsx)("span",{className:"text-gray-600 ml-2",children:"\uD83D\uDC64"}),(0,n.jsx)("span",{className:"text-gray-600",children:"שם: "}),(0,n.jsx)("span",{className:"font-medium mr-2",children:e.name})]}),(0,n.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[(0,n.jsx)("span",{className:"text-gray-600 ml-2",children:"\uD83D\uDCF1"}),(0,n.jsx)("span",{className:"text-gray-600",children:"טלפון: "}),(0,n.jsx)("span",{className:"font-medium mr-2",dir:"ltr",children:e.phone})]}),(0,n.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[(0,n.jsx)("span",{className:"text-gray-600 ml-2",children:"\uD83D\uDEE1️"}),(0,n.jsx)("span",{className:"text-gray-600",children:"סוג משתמש: "}),(0,n.jsx)("span",{className:"font-medium mr-2",children:e.isAdmin?"מנהל":"משתמש רגיל"})]}),(0,n.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[(0,n.jsx)("span",{className:"text-gray-600 ml-2",children:"\uD83D\uDEE1️"}),(0,n.jsx)("span",{className:"text-gray-600",children:"סוג מנוי: "}),(0,n.jsx)("span",{className:"font-medium mr-2",children:e.membership||"לא מוגדר"})]})]})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4",children:"השיעורים שנרשמת אליהם"}),c?(0,n.jsx)("p",{className:"text-center text-gray-500 py-4",children:"טוען שיעורים..."}):s.length>0?(0,n.jsx)("div",{className:"space-y-4",children:s.map((e,s)=>(0,n.jsx)(i,{lesson:e},s))}):(0,n.jsx)("p",{className:"text-center text-gray-500 py-4",children:"לא נרשמת לשום שיעור"})]})]}):(0,n.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,n.jsx)("div",{className:"text-gray-500",children:"טוען..."})})}},3562:(e,s,t)=>{t.r(s),t.d(s,{default:()=>x});var l=t(6540),a=t(9416),r=t(5150),n=t(4848);let i=e=>{let s=new Date(e);return new Intl.DateTimeFormat("he-IL",{weekday:"long",day:"2-digit",month:"2-digit",year:"numeric"}).format(s)},d=({lesson:e,isRegistered:s,onRegister:t,onCancel:l})=>{let a=i(e.date);return(0,n.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-4 border border-gray-200 flex flex-col",children:[(0,n.jsx)("div",{className:"text-lg font-semibold text-gray-800",children:a}),(0,n.jsxs)("div",{className:"text-lg font-semibold text-gray-800",children:[e.type," עם ",e.instructor]}),(0,n.jsxs)("div",{className:"text-gray-600 mt-1",children:["שעה: ",e.time]}),(0,n.jsxs)("div",{className:"text-gray-600 mt-1",children:["משתתפים מקסימליים: ",e.maxParticipants]}),(0,n.jsxs)("div",{className:"text-gray-600 mt-1",children:["משתתפים רשומים: ",e.registeredParticipants]}),(0,n.jsxs)("div",{className:"text-gray-600 mt-1",children:["מקומות פנויים: ",e.maxParticipants-e.registeredParticipants]}),s?(0,n.jsx)("button",{onClick:()=>l(e),className:"mt-4 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600",children:"בטל הרשמה"}):(0,n.jsx)("button",{onClick:()=>t(e),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"הירשם לשיעור"})]})};var c=t(2409);let x=()=>{let[e,s]=(0,l.useState)([]),[t,i]=(0,l.useState)(!0),[x,o]=(0,l.useState)(""),{userData:m}=(0,a.J)();(0,l.useEffect)(()=>{h()},[]);let h=async()=>{try{let e=await (0,r.yo)(),t=new Date,l=e.map(e=>({...e,isActive:new Date(`${e.date} ${e.time}`)>=t}));s(l.filter(e=>e.isActive))}catch(e){o("אירעה שגיאה בטעינת לוח השיעורים")}finally{i(!1)}},g=async e=>{try{await (0,r.Ry)(e.id,m,!0),h()}catch(e){o("אירעה שגיאה בהרשמה לשיעור")}},u=async e=>{try{await (0,r.Ry)(e.id,m,!1),h()}catch(e){o("אירעה שגיאה בביטול ההרשמה לשיעור")}};return(0,n.jsxs)("div",{className:"container mx-auto p-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"לוח שיעורים"}),x&&(0,n.jsx)(c.A,{message:x}),t?(0,n.jsx)("div",{className:"text-center text-gray-500",children:"טוען..."}):e.map(e=>(0,n.jsx)(d,{lesson:e,isRegistered:e.waitingList.includes(m.phone),onRegister:g,onCancel:u},e.id))]})}},2409:(e,s,t)=>{t.d(s,{A:()=>a}),t(6540);var l=t(4848);let a=({message:e})=>(0,l.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:(0,l.jsx)("span",{className:"block sm:inline",children:e})})}}]);