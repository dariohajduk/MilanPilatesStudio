exports.id=689,exports.ids=[689],exports.modules={689:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>y});var l=t(2015),r=t(5983),d=t(4337),i=t(2163),n=t(4716),c=t.n(n),o=t(8700),m=t(1111),x=t(5788),u=t(1966),h=t(2115),b=t(2603),g=t(8732),p=e([r,d,o,m,x,u,b]);[r,d,o,m,x,u,b]=p.then?(await p)():p;let f=()=>{let[e,s]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{},[]),e},j={responsive:!0,plugins:{legend:{position:"top"}}},y=({setCurrentScreen:e})=>{let[s,t]=(0,l.useState)(null),[a,n]=(0,l.useState)(null),[b,p]=(0,l.useState)(null),[y,v]=(0,l.useState)(null),[N,w]=(0,l.useState)(!0),{setLogoUrl:S}=(0,i.x)(),[C,M]=(0,l.useState)("dashboard"),[k,E]=(0,l.useState)(!1),D=f();(0,l.useEffect)(()=>{L(),P(),$(),T(),O()},[]);let L=async()=>{try{let e=(await (0,d.getDocs)((0,d.collection)(r.db,"Lessons"))).docs.map(e=>e.data()),s=c()().startOf("week"),a=c()().startOf("month"),l=0,i=0,n=0;e.forEach(e=>{let t=c()(`${e.date} ${e.time}`,"YYYY-MM-DD HH:mm");t.isSameOrAfter(s)&&(l+=e.registeredParticipants||0),t.isSameOrAfter(a)&&(i+=e.registeredParticipants||0),e.isActive&&n++}),t({activeLessons:n,weeklyRegistrations:l,monthlyRegistrations:i})}catch(e){console.error("Error loading stats:",e)}finally{w(!1)}},P=async()=>{try{let e=(await (0,d.getDocs)((0,d.collection)(r.db,"Lessons"))).docs.map(e=>e.data()),s={};[void 0,void 0,void 0,void 0].map((e,s)=>c()().subtract(s,"months").format("MMMM")).reverse().forEach(e=>s[e]=0),e.forEach(e=>{let t=c()(e.date,"YYYY-MM-DD").format("MMMM");void 0!==s[t]&&(s[t]+=e.registeredParticipants||0)}),n({labels:Object.keys(s),datasets:[{label:"הרשמות חודשיות",data:Object.values(s),borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.5)",tension:.1}]})}catch(e){console.error("Error loading chart data:",e)}},$=async()=>{try{let e=(await (0,d.getDocs)((0,d.collection)(r.db,"Users"))).docs.map(e=>e.data()).reduce((e,s)=>{let t=s.type||s.subscriptionType||s.membershipType;return t&&(e[t]=(e[t]||0)+1),e},{});p({labels:Object.keys(e),datasets:[{label:"סוגי מנויים",data:Object.values(e),backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)"],borderWidth:1}]})}catch(e){console.error("Error loading pie chart data:",e)}},T=async()=>{try{let e=(await (0,d.getDocs)((0,d.collection)(r.db,"Users"))).docs.map(e=>e.data()),s={};[void 0,void 0,void 0,void 0].map((e,s)=>c()().subtract(s,"months").format("MMMM")).reverse().forEach(e=>s[e]=0),e.forEach(e=>{let t=c()(e.joinDate,"YYYY-MM-DD").format("MMMM");void 0!==s[t]&&s[t]++}),v({labels:Object.keys(s),datasets:[{label:"משתמשים חדשים",data:Object.values(s),backgroundColor:"rgba(54, 162, 235, 0.6)"}]})}catch(e){console.error("Error loading bar chart data:",e)}},O=async()=>{try{let e=(0,d.doc)(r.db,"StudioInfo","Logo"),s=await (0,d.getDoc)(e);s.exists()&&S(s.data()?.logoBase64)}catch(e){console.error("Error fetching logo:",e)}},Y=async e=>{let s=e.target.files[0];if(s)try{let e=new FileReader;e.onloadend=async()=>{let s=e.result,t=(0,d.doc)(r.db,"StudioInfo","Logo");await (0,d.setDoc)(t,{logoBase64:s}),S(s)},e.readAsDataURL(s)}catch(e){console.error("Error uploading logo:",e),alert("אירעה שגיאה בהעלאת הלוגו")}},A=[{id:"dashboard",label:"לוח בקרה",icon:"\uD83D\uDCCA"},{id:"users",label:"ניהול משתמשים",icon:"\uD83D\uDC65"},{id:"lessons",label:"ניהול שיעורים",icon:"\uD83D\uDCC5"},{id:"manager",label:"ניהול מנהלים",icon:"⚙️"},{id:"tests",label:"ניהול בדיקות (Jest)",icon:"\uD83E\uDDEA"}];return(0,g.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,g.jsxs)("div",{className:"bg-white shadow-lg md:w-1/4 w-full md:block",children:[(0,g.jsx)("div",{className:"p-4 border-b",children:(0,g.jsx)("h1",{className:"text-xl font-bold",children:"ניהול מערכת"})}),D?(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsxs)("button",{onClick:()=>E(!k),className:"flex items-center p-3 mx-auto w-full text-gray-600 bg-gray-50 rounded-lg shadow-md md:hidden",children:["תפריט",(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ml-2 transition-transform ${k?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),k&&(0,g.jsx)("div",{className:"absolute w-full bg-white shadow-lg z-10 rounded-lg",children:A.map(e=>(0,g.jsxs)("button",{onClick:()=>{M(e.id),E(!1)},className:`flex items-center p-3 w-full text-left ${C===e.id?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-50"}`,children:[(0,g.jsx)("span",{className:"mr-3",children:e.icon}),e.label]},e.id))})]}):(0,g.jsx)("nav",{className:"p-4 flex flex-col hidden md:block",children:A.map(e=>(0,g.jsxs)("button",{onClick:()=>M(e.id),className:`flex items-center p-3 rounded-lg transition-colors ${C===e.id?"bg-blue-50 text-blue-700":"text-gray-600 hover:bg-gray-50"}`,children:[(0,g.jsx)("span",{className:"mr-3",children:e.icon}),e.label]},e.id))})]}),(0,g.jsx)("div",{className:"flex-1 p-8 overflow-auto",children:(()=>{switch(C){case"dashboard":return(0,g.jsx)("div",{className:"space-y-3",children:(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,g.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,g.jsx)("h2",{className:"text-xl font-bold mb-4",children:"סטטיסטיקות מהירות"}),N?(0,g.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,g.jsx)("div",{className:"h- bg-gray-200 rounded"}),(0,g.jsx)("div",{className:"h-25 bg-gray-200 rounded"}),(0,g.jsx)("div",{className:"h-25 bg-gray-200 rounded"})]}):(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,g.jsx)("span",{className:"text-gray-600",children:"שיעורים פעילים"}),(0,g.jsx)("span",{className:"font-semibold",children:s?.activeLessons||0})]}),(0,g.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,g.jsx)("span",{className:"text-gray-600",children:"נרשמים השבוע"}),(0,g.jsx)("span",{className:"font-semibold",children:s?.weeklyRegistrations||0})]}),(0,g.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,g.jsx)("span",{className:"text-gray-600",children:"נרשמים החודש"}),(0,g.jsx)("span",{className:"font-semibold",children:s?.monthlyRegistrations||0})]})]})]}),(0,g.jsxs)("div",{className:"bg-white rounded-lg p-2 shadow-sm",children:[(0,g.jsxs)("div",{className:"bg-white rounded-lg p-2 shadow-sm",children:[(0,g.jsx)("h2",{className:"text-xl font-bold mb-1",children:"העלאת לוגו"}),(0,g.jsx)("input",{type:"file",onChange:Y,accept:"image/*",className:"file:mr-4 file:py-2 file:px-4\r file:rounded-full file:border-0\r file:text-sm file:font-semibold\r file:bg-blue-50 file:text-blue-700\r hover:file:bg-blue-100"})]}),(0,g.jsx)("h2",{className:"text-xl font-bold mb-2",children:"מגמת הרשמות"}),(0,g.jsx)("div",{className:"w-full",children:a&&(0,g.jsx)(o.Line,{data:a,options:j})})]}),(0,g.jsxs)("div",{className:"bg-white rounded-lg p-1 shadow-sm",children:[(0,g.jsx)("h2",{className:"text-xl font-bold mb-1",children:"התפלגות סוגי מנויים"}),(0,g.jsx)("div",{className:"h-64 w-64 mx-auto",children:b&&(0,g.jsx)(o.Pie,{data:b,options:j})})]}),(0,g.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,g.jsx)("h2",{className:"text-xl font-bold mb-4",children:"משתמשים חדשים"}),(0,g.jsx)("div",{className:"h-full w-full mx-auto",children:y&&(0,g.jsx)(o.Bar,{data:y,options:j})})]})]})});case"users":return(0,g.jsx)(x.default,{});case"lessons":return(0,g.jsx)(m.default,{});case"manager":return(0,g.jsx)(u.default,{});case"tests":return(0,g.jsx)(h.default,{});default:return null}})()})]})};a()}catch(e){a(e)}})},1111:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>h});var l=t(2015),r=t(1129),d=t(4801),i=t(4337),n=t(5983),c=t(4716),o=t.n(c);t(9893);var m=t(8732),x=e([r,i,n]);[r,i,n]=x.then?(await x)():x,(0,d.momentLocalizer)(o());let u=()=>{let[e,s]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{},[]),e},h=()=>{let{lessons:e=[],addLesson:s,removeLesson:t}=(0,r.H)()||{},[a,d]=(0,l.useState)([]),c=u(),[x,h]=(0,l.useState)(!1),[b,g]=(0,l.useState)({instructor:"",type:"",maxParticipants:0,date:"",time:""});(0,l.useEffect)(()=>{let t=!0;return(async()=>{try{let a=await (0,i.getDocs)((0,i.collection)(n.db,"LessonTypes"));if(!t)return;d(a.docs.map(e=>({id:e.id,...e.data()})));let l=(0,i.collection)(n.db,"Lessons"),r=await (0,i.getDocs)(l);if(!t)return;let c=r.docs.map(e=>({id:e.id,...e.data()})),o=e.map(e=>e.id);c.forEach(e=>{e.id&&!o.includes(e.id)&&s(e)})}catch(e){console.error("Error fetching data:",e)}})(),()=>{t=!1}},[e,s]);let p=async()=>{if(""===b.instructor.trim()||""===b.type.trim()||b.maxParticipants<=0||c&&(""===b.date||""===b.time)){alert("אנא מלא את כל השדות בטופס");return}let e={date:b.date,time:b.time,instructor:b.instructor,type:b.type,maxParticipants:b.maxParticipants.toString(),registeredParticipants:0,createdAt:o()().toISOString(),title:`${b.type} - ${b.instructor}`,isActive:o()(`${b.date}T${b.time}`).isAfter(o()()),waitingList:[]};try{let t=await (0,i.addDoc)((0,i.collection)(n.db,"Lessons"),e);s({id:t.id,...e}),g({instructor:"",type:"",maxParticipants:0,date:"",time:""}),h(!1)}catch(e){console.error("Error adding lesson:",e),alert("אירעה שגיאה בהוספת השיעור")}};return(0,m.jsxs)("div",{className:"container mx-auto p-4",children:[(0,m.jsx)("h1",{className:"text-xl font-bold mb-4",children:"ניהול שיעורים"}),(0,m.jsx)("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-blue-500 text-white rounded-lg",children:"הוסף שיעור"}),x&&(0,m.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-75 flex justify-center items-center",children:(0,m.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[(0,m.jsx)("h2",{className:"text-lg font-bold mb-4",children:"הוסף שיעור"}),(0,m.jsx)("input",{type:"text",placeholder:"שם המדריך",value:b.instructor,onChange:e=>g({...b,instructor:e.target.value}),className:"w-full p-2 border rounded-lg mb-2",required:!0}),(0,m.jsxs)("select",{value:b.type,onChange:e=>g({...b,type:e.target.value}),className:"w-full p-2 border rounded-lg mb-2",children:[(0,m.jsx)("option",{value:"",disabled:!0,children:"בחר סוג שיעור"}),a.map(e=>(0,m.jsx)("option",{value:e.type,children:e.type},e.id))]}),(0,m.jsx)("input",{type:"number",placeholder:"מספר משתתפים מקסימלי",value:b.maxParticipants,onChange:e=>g({...b,maxParticipants:parseInt(e.target.value)||0}),className:"w-full p-2 border rounded-lg mb-2",min:"1",required:!0}),c&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("input",{type:"date",value:b.date,onChange:e=>g({...b,date:e.target.value}),className:"w-full p-2 border rounded-lg mb-2",required:!0}),(0,m.jsx)("input",{type:"time",value:b.time,onChange:e=>g({...b,time:e.target.value}),className:"w-full p-2 border rounded-lg mb-2",required:!0})]}),(0,m.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,m.jsx)("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-500 text-white rounded-lg",children:"ביטול"}),(0,m.jsx)("button",{onClick:p,className:"px-4 py-2 bg-green-500 text-white rounded-lg",children:"הוסף"})]})]})})]})};a()}catch(e){a(e)}})},1966:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>c});var l=t(2015),r=t(8025),d=t(8732),i=e([r]);r=(i.then?(await i)():i)[0];let n=({items:e,onDelete:s})=>(0,d.jsx)("ul",{className:"mt-4 space-y-2",children:e.map(e=>(0,d.jsxs)("li",{className:"flex justify-between items-center border p-2 rounded",children:[(0,d.jsx)("span",{children:e.name}),(0,d.jsx)("button",{onClick:()=>s(e.id),className:"text-red-500",children:"מחק"})]},e.id))}),c=()=>{let[e,s]=(0,l.useState)([]),[t,a]=(0,l.useState)(""),[i,c]=(0,l.useState)([]),[o,m]=(0,l.useState)(""),[x,u]=(0,l.useState)(!1),[h,b]=(0,l.useState)("");(0,l.useEffect)(()=>{g(),p()},[]);let g=async()=>{try{let e=await (0,r.t9)("LessonTypes");s(e)}catch(e){f(e)}},p=async()=>{try{let e=await (0,r.t9)("Memberships");c(e)}catch(e){f(e)}},f=e=>{console.error(e),b("אירעה שגיאה, נסו שוב מאוחר יותר.")},j=async()=>{if(!t.trim()){b("שם סוג שיעור אינו יכול להיות ריק.");return}u(!0);try{let l=await (0,r.tI)("LessonTypes",{name:t.trim()});s([...e,l]),a("")}catch(e){f(e)}finally{u(!1)}},y=async()=>{if(!o.trim()){b("שם מנוי אינו יכול להיות ריק.");return}u(!0);try{let e=await (0,r.tI)("Memberships",{name:o.trim()});c([...i,e]),m("")}catch(e){f(e)}finally{u(!1)}},v=async t=>{u(!0);try{await (0,r.Nn)("LessonTypes",t),s(e.filter(e=>e.id!==t))}catch(e){f(e)}finally{u(!1)}},N=async e=>{u(!0);try{await (0,r.Nn)("Memberships",e),c(i.filter(s=>s.id!==e))}catch(e){f(e)}finally{u(!1)}};return(0,d.jsxs)("div",{className:"p-6",children:[(0,d.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"ניהול סוגי שיעורים ומנויים"}),h&&(0,d.jsx)("div",{className:"bg-red-100 text-red-700 p-4 rounded-lg mb-4",children:h}),(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsx)("h2",{className:"text-xl font-bold mb-4",children:"ניהול סוגי שיעורים"}),(0,d.jsx)("input",{type:"text",value:t,onChange:e=>a(e.target.value),placeholder:"הוסף סוג שיעור חדש",className:"p-2 border rounded w-full"}),(0,d.jsx)("button",{onClick:j,disabled:x||!t.trim(),className:`bg-blue-500 text-white px-4 py-2 rounded mt-2 ${x?"opacity-50":""}`,children:x?"מוסיף...":"הוסף סוג שיעור"}),(0,d.jsx)(n,{items:e,onDelete:v})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-xl font-bold mb-4",children:"ניהול מנויים"}),(0,d.jsx)("input",{type:"text",value:o,onChange:e=>m(e.target.value),placeholder:"הוסף מנוי חדש",className:"p-2 border rounded w-full"}),(0,d.jsx)("button",{onClick:y,disabled:x||!o.trim(),className:`bg-green-500 text-white px-4 py-2 rounded mt-2 ${x?"opacity-50":""}`,children:x?"מוסיף...":"הוסף מנוי"}),(0,d.jsx)(n,{items:i,onDelete:N})]})]})};a()}catch(e){a(e)}})},2115:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var a=t(2015),l=t(8732);let r=e=>e.split(/(\\|\/)/).pop(),d=({passed:e,failed:s,total:t})=>(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[(0,l.jsx)("div",{className:"text-lg font-bold",children:t}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:'סה"כ בדיקות'})]}),(0,l.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[(0,l.jsx)("div",{className:"text-lg font-bold text-green-700",children:e}),(0,l.jsx)("div",{className:"text-sm text-green-600",children:"עברו"})]}),(0,l.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg text-center",children:[(0,l.jsx)("div",{className:"text-lg font-bold text-red-700",children:s}),(0,l.jsx)("div",{className:"text-sm text-red-600",children:"נכשלו"})]})]}),i=({suite:e})=>{let s="passed"===e.status;return(0,l.jsxs)("div",{className:"border rounded-lg p-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,l.jsx)("h3",{className:"font-bold",children:r(e.name)}),(0,l.jsx)("span",{className:`px-2 py-1 text-sm rounded-full ${s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s?"עבר":"נכשל"})]}),e.assertionResults?.map((e,s)=>l.jsxs("div",{className:`border-l-4 pl-3 py-2 mb-2 ${"passed"===e.status?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`,children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${"passed"===e.status?"bg-green-500":"bg-red-500"}`}),l.jsx("span",{children:e.title})]}),"failed"===e.status&&e.failureMessages?.map((e,s)=>l.jsx("div",{className:"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded",children:e.split("\n")[0]},s))]},s))]})},n=()=>{let[e,s]=(0,a.useState)(null),[t,r]=(0,a.useState)(!1),[n,c]=(0,a.useState)(null);process.env.REACT_APP_API_URL;let o=async()=>{r(!0),c(null),s(null);try{let e;let t=await fetch("api/tests/run-tests",{method:"POST",headers:{"Content-Type":"application/json"}}),a=await t.text();try{e=a?JSON.parse(a):{}}catch(e){throw Error("Invalid JSON response from server")}if(!t.ok)throw Error(e.details||e.error||"Server error occurred");console.log("Received test results:",e),s(e)}catch(e){console.error("Test run error:",e),c(`Error running tests: ${e.message}`)}finally{r(!1)}};return(0,l.jsxs)("div",{className:"relative min-h-screen",children:[(0,l.jsx)("div",{className:"sticky top-0 bg-white shadow-md z-50 p-4 border-b",children:(0,l.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"ניהול בדיקות (Jest)"}),(0,l.jsx)("button",{onClick:o,disabled:t,className:`px-4 py-2 rounded-lg ${t?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"} text-white transition-colors`,children:t?"מריץ בדיקות...":"הרץ בדיקות"})]})}),(0,l.jsxs)("div",{className:"container mx-auto p-4",children:[t&&(0,l.jsxs)("div",{className:"flex justify-center items-center p-8",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),(0,l.jsx)("span",{className:"mr-3",children:"טוען בדיקות..."})]}),n&&(0,l.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6",children:(0,l.jsx)("div",{className:"flex",children:(0,l.jsxs)("div",{className:"mr-3",children:[(0,l.jsx)("p",{className:"font-bold",children:"שגיאה בהרצת הבדיקות"}),(0,l.jsx)("p",{className:"text-sm",children:n})]})})}),!t&&!n&&e&&(0,l.jsxs)("div",{children:[(0,l.jsx)(d,{...e?{total:e.numTotalTests||0,passed:e.numPassedTests||0,failed:e.numFailedTests||0}:{total:0,passed:0,failed:0}}),(0,l.jsx)("div",{className:"space-y-4",children:e.testResults?.map((e,s)=>l.jsx(i,{suite:e},s))})]}),!t&&!n&&!e&&(0,l.jsx)("div",{className:"text-center text-gray-500 p-8",children:(0,l.jsx)("p",{className:"text-lg",children:'לחץ על "הרץ בדיקות" כדי להתחיל'})})]})]})}},1129:(e,s,t)=>{"use strict";t.a(e,async(e,a)=>{try{t.d(s,{H:()=>c});var l=t(2015),r=t(5983),d=t(4337);t(8732);var i=e([r,d]);[r,d]=i.then?(await i)():i;let n=(0,l.createContext)(),c=()=>(0,l.useContext)(n);a()}catch(e){a(e)}})},9893:()=>{}};