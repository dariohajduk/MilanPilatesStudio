exports.id=229,exports.ids=[229],exports.modules={5788:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>l});var r=s(2015),n=s(8025),i=s(9987),o=s(8732),d=e([n,i]);[n,i]=d.then?(await d)():d;let l=()=>{let[e,t]=(0,r.useState)({name:"",phone:"",isAdmin:!1,membership:"",remainingLessons:0,registeredLessons:[],completedLessons:0,joinDate:new Date().toISOString().split("T")[0]}),[s,a]=(0,r.useState)(""),[d,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(!1),[p,b]=(0,r.useState)(null),[g,x]=(0,r.useState)([])||{},{refreshUserData:y}=(0,i.J)()||{};(0,r.useEffect)(()=>{w()},[]);let w=async()=>{try{let e=await (0,n.hU)();x(e)}catch(e){f("שגיאה בטעינת המשתמשים")}},f=e=>{console.error(e),u(e)},v=async()=>{if(!e.name||!e.phone||!e.membership){f("אנא מלא את כל השדות החובה");return}try{await (0,n.nu)(e),x(t=>[...t,{id:e.phone,...e}]),h(!1),u(""),P()}catch(e){f("שגיאה בהוספת המשתמש")}},j=async()=>{if(!p.name||!p.phone||!p.membership){u("אנא מלא את כל השדות החובה");return}try{await (0,n.gw)(p.id,p),x(e=>e.map(e=>e.id===p.id?{...p}:e)),b(null),h(!1),u("")}catch(e){console.error("Error editing user:",e),u("שגיאה בעדכון המשתמש")}},S=async e=>{if(window.confirm("האם אתה בטוח שברצונך למחוק את המשתמש?"))try{await (0,n.hG)(e),x(t=>t.filter(t=>t.id!==e))}catch(e){f("שגיאה במחיקת המשתמש")}},P=()=>{t({name:"",phone:"",isAdmin:!1,membership:"",remainingLessons:0,registeredLessons:[],completedLessons:0,joinDate:new Date().toISOString().split("T")[0]})},N=g.filter(e=>(!s||e.name.includes(s)||e.phone.includes(s))&&(!d||e.membership===d));return(0,o.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[(0,o.jsx)("input",{type:"text",placeholder:"חפש לפי שם או טלפון",value:s,onChange:e=>a(e.target.value),className:"p-2 border rounded-lg w-full sm:w-1/2 mb-2 sm:mb-0"}),(0,o.jsx)("button",{onClick:()=>{P(),h(!0)},className:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 mb-4 w-full sm:w-auto",children:"הוסף משתמש"})]}),(0,o.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,o.jsx)("h2",{className:"text-lg font-bold mb-4",children:"רשימת משתמשים"}),(0,o.jsx)("ul",{className:"space-y-3",children:N.map(e=>(0,o.jsxs)("li",{className:"flex justify-between items-center p-3 rounded-md bg-gray-100",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{children:e.name}),(0,o.jsx)("p",{children:e.phone})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:()=>{b(e),h(!0)},className:"bg-yellow-500 text-white px-3 py-1 rounded-md hover:bg-yellow-600",children:"ערוך"}),(0,o.jsx)("button",{onClick:()=>S(e.id),className:"bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600",children:"מחק"})]})]},e.id))})]}),m&&(0,o.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center",children:(0,o.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-lg max-w-md w-full",children:[(0,o.jsx)("h2",{className:"text-lg font-bold mb-4",children:p?"ערוך משתמש":"הוסף משתמש"}),c&&(0,o.jsx)("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg mb-4",children:c}),(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsx)("input",{type:"text",name:"name",placeholder:"שם מלא",value:p?p.name:e.name,onChange:e=>p?b(t=>({...t,name:e.target.value})):t(t=>({...t,name:e.target.value})),className:"w-full p-2 border rounded-md"}),(0,o.jsx)("input",{type:"tel",name:"phone",placeholder:"טלפון",value:p?p.phone:e.phone,onChange:e=>p?b(t=>({...t,phone:e.target.value})):t(t=>({...t,phone:e.target.value})),className:"w-full p-2 border rounded-md"}),(0,o.jsxs)("select",{name:"membership",value:p?p.membership:e.membership,onChange:e=>{let s=e.target.value;p?b(e=>({...e,membership:s})):t(e=>({...e,membership:s}))},className:"w-full p-2 border rounded-md",children:[(0,o.jsx)("option",{value:"",children:"בחר מנוי"}),(0,o.jsx)("option",{value:"כרטיסייה",children:"כרטיסייה"}),(0,o.jsx)("option",{value:"מנוי חודשי",children:"מנוי חודשי"})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-2 rtl:space-x-reverse",children:[(0,o.jsx)("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-500 text-white rounded-md",children:"ביטול"}),(0,o.jsx)("button",{onClick:p?j:v,className:"px-4 py-2 bg-green-500 text-white rounded-md",children:p?"שמור שינויים":"הוסף"})]})]})]})})]})};a()}catch(e){a(e)}})},4608:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>d});var r=s(2163),n=s(9987);s(7160);var i=s(8732),o=e([n]);function d({Component:e,pageProps:t}){return(0,i.jsx)(n.v,{children:(0,i.jsx)(r.V,{children:(0,i.jsx)(e,{...t})})})}n=(o.then?(await o)():o)[0],a()}catch(e){a(e)}})},2163:(e,t,s)=>{"use strict";s.d(t,{V:()=>i,x:()=>o});var a=s(2015),r=s(8732);let n=(0,a.createContext)(null),i=({children:e})=>{let[t,s]=(0,a.useState)("https://your-default-logo-url.com/logo.png");return(0,r.jsx)(n.Provider,{value:{logoUrl:t,setLogoUrl:s},children:e})},o=()=>{let e=(0,a.useContext)(n);if(!e)throw Error("useLogo must be used within a LogoProvider");return e}},9987:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{J:()=>u,v:()=>c});var r=s(2015),n=s(5983),i=s(4337),o=s(8732),d=e([n,i]);[n,i]=d.then?(await d)():d;let l=(0,r.createContext)(),c=({children:e})=>{let[t,s]=(0,r.useState)(null),[a,d]=(0,r.useState)(!1),c=async e=>{try{let t=(0,i.doc)(n.db,"Users",e.phone),a=await (0,i.getDoc)(t);if(a.exists()){let t=a.data();s({...t,phone:e.phone,isAdmin:!!t.isAdmin}),d(!0)}else console.error("User not found in Firebase")}catch(e){console.error("Error fetching user data from Firebase:",e)}},u=async e=>{if(!e){console.error("Cannot refresh user data: phone is undefined");return}try{let t=(0,i.doc)(n.db,"Users",e),a=await (0,i.getDoc)(t);if(a.exists()){let t=a.data();s({...t,phone:e})}else console.error("User not found in Firebase")}catch(e){console.error("Error refreshing user data:",e)}};return(0,o.jsx)(l.Provider,{value:{userData:t,isLoggedIn:a,updateUserData:c,refreshUserData:u,logout:()=>{s(null),d(!1)}},children:e})},u=()=>(0,r.useContext)(l);a()}catch(e){a(e)}})},5983:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{db:()=>l});var r=s(6551),n=s(4337),i=s(2537),o=e([r,n,i]);[r,n,i]=o.then?(await o)():o;let d=(0,r.initializeApp)({apiKey:"AIzaSyBgRjJShNJqWB2nq931kKobLRHUeejW0vo",authDomain:"milan-studio-b8b4b.firebaseapp.com",databaseURL:"https://milan-studio-b8b4b-default-rtdb.europe-west1.firebasedatabase.app",projectId:"milan-studio-b8b4b",storageBucket:"milan-studio-b8b4b.firebasestorage.app",messagingSenderId:"961084768524",appId:"1:961084768524:web:2cdbc3a67dc018d8058929",measurementId:"G-8XF83E9KQY"}),l=(0,n.getFirestore)(d);(0,i.getStorage)(d),a()}catch(e){a(e)}})},8025:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{Nn:()=>l,R0:()=>u,Ry:()=>m,gw:()=>b,hG:()=>g,hU:()=>h,nu:()=>p,t9:()=>o,tI:()=>d,yo:()=>c});var r=s(4337),n=s(5983),i=e([r,n]);[r,n]=i.then?(await i)():i;let o=async e=>(await (0,r.getDocs)((0,r.collection)(n.db,e))).docs.map(e=>({id:e.id,...e.data()})),d=async(e,t)=>({id:(await (0,r.addDoc)((0,r.collection)(n.db,e),t)).id,...t}),l=async(e,t)=>{await (0,r.deleteDoc)((0,r.doc)(n.db,e,t))},c=async()=>(await (0,r.getDocs)((0,r.collection)(n.db,"Lessons"))).docs.map(e=>({id:e.id,...e.data()})),u=async e=>{let t=(0,r.doc)(n.db,"Users",e),s=await (0,r.getDoc)(t);return s.exists()&&s.data().registeredLessons||[]},m=async(e,t,s)=>{let a=(0,r.doc)(n.db,"Lessons",e),i=(0,r.doc)(n.db,"Users",t.phone),o=s?{waitingList:(0,r.arrayUnion)(t.phone),registeredParticipants:(t.registeredParticipants||0)+1}:{waitingList:(0,r.arrayRemove)(t.phone),registeredParticipants:Math.max((t.registeredParticipants||0)-1,0)},d=s?{registeredLessons:(0,r.arrayUnion)({id:e,date:new Date().toISOString(),type:"Lesson Type"})}:{registeredLessons:(0,r.arrayRemove)({id:e,date:new Date().toISOString()})};await (0,r.updateDoc)(a,o),await (0,r.updateDoc)(i,d)},h=async()=>(await (0,r.getDocs)((0,r.collection)(n.db,"Users"))).docs.map(e=>({id:e.id,...e.data()})),p=async e=>{let t=(0,r.doc)(n.db,"Users",e.phone);await (0,r.setDoc)(t,e)},b=async(e,t)=>{let s=(0,r.doc)(n.db,"Users",e);await (0,r.updateDoc)(s,t)},g=async e=>{let t=(0,r.doc)(n.db,"Users",e);await (0,r.deleteDoc)(t)};a()}catch(e){a(e)}})},671:(e,t)=>{"use strict";Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},7160:()=>{},9455:(e,t)=>{"use strict";Object.defineProperty(t,"A",{enumerable:!0,get:function(){return s}});var s=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};