{"version":3,"sources":["firebase.js","contexts/UserContext.js","contexts/LogoContext.js","pages/LoginForm.js","utils.js","pages/Home.js","services/firebaseService.js","components/LessonCard.js","components/ErrorMessage.js","pages/Schedule.js","components/LessonItem.js","pages/ProfileScreen.js","contexts/LessonsContext.js","pages/LessonManagement.js","pages/UserManagement.js","pages/ManagerPage.js","pages/TestsScreen.js","pages/AdminDashboard.js","components/TopNav.js","App.js","index.js"],"names":["app","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","db","getFirestore","getStorage","UserContext","createContext","UserProvider","_ref","children","userData","setUserData","useState","isLoggedIn","setIsLoggedIn","_jsx","Provider","value","updateUserData","async","userRef","doc","data","phone","userDoc","getDoc","exists","docData","_objectSpread","isAdmin","Boolean","console","error","refreshUserData","logout","useUser","useContext","LogoContext","LogoProvider","logoUrl","setLogoUrl","useLogo","context","Error","LoginForm","setCurrentScreen","setPhone","isLoading","setIsLoading","setError","loading","log","ADMIN","name","className","_jsxs","src","alt","onSubmit","e","preventDefault","test","registeredLessons","completedLessons","membershipType","joinDate","Date","toISOString","err","message","htmlFor","id","type","onChange","target","replace","disabled","placeholder","dir","maxLength","fill","viewBox","cx","cy","r","stroke","strokeWidth","d","InfoBox","title","LessonItem","_ref2","lesson","date","toLocaleDateString","time","Statistic","_ref3","label","Detail","_ref4","Home","today","setHours","endOfWeek","setDate","getDate","getDay","upcomingLessons","calculateUpcomingLessons","_userData$registeredL","filter","lessonDate","pastLessonsCount","calculatePastLessonsCount","_userData$registeredL2","length","lessonsPerWeek","diffInMilliseconds","diffInWeeks","Math","ceil","toFixed","calculateLessonsPerWeek","getGreeting","hour","getHours","map","index","fetchCollection","getDocs","collection","collectionName","docs","addDocument","newDoc","addDoc","deleteDocument","deleteDoc","updateLessonRegistration","lessonId","isRegistering","lessonRef","lessonUpdate","waitingList","arrayUnion","registeredParticipants","arrayRemove","max","userUpdate","updateDoc","LessonCard","isRegistered","onRegister","onCancel","formattedDate","dateString","Intl","DateTimeFormat","weekday","day","month","year","format","formatDateWithWeekday","instructor","maxParticipants","onClick","ErrorMessage","role","Schedule","classes","setClasses","useEffect","fetchClasses","lessonsData","fetchLessons","now","updatedLessons","isActive","concat","handleRegister","handleCancelRegistration","includes","ProfileScreen","setRegisteredLessons","fetchRegisteredLessons","useCallback","futureLessons","userSnap","getUserLessons","membership","LessonsContext","localizer","momentLocalizer","moment","LessonManagement","lessons","addLesson","removeLesson","clearAllLessons","lessonTypes","setLessonTypes","isMobile","useIsMobile","setIsMobile","window","innerWidth","handleResize","addEventListener","removeEventListener","selectedTimes","setSelectedTimes","showForm","setShowForm","showHistory","setShowHistory","formData","setFormData","isMounted","typesSnapshot","types","lessonsRef","lessonsSnapshot","fetchedLessons","l","existingLessonIds","forEach","fetchData","currentLessons","pastLessons","reduce","acc","push","groupLessonsByDate","lessonList","currentLessonsByDate","pastLessonsByDate","handleDeleteLesson","confirm","alert","events","sort","a","b","diff","lessonStart","lessonEnd","setMinutes","start","end","isPast","handleClearAllLessons","Object","keys","_pastLessonsByDate$da","_currentLessonsByDate","Calendar","selectable","onSelectSlot","isAfter","newSelection","current","nextHour","prev","slot","some","newSlot","getTime","style","height","width","fontSize","defaultView","views","step","timeslots","min","messages","week","previous","next","eventPropGetter","event","backgroundColor","color","border","borderLeft","display","flexDirection","justifyContent","padding","marginLeft","components","_event$lesson","gap","alignItems","stopPropagation","timeSlotWrapper","_ref5","styleProps","isSelected","timeSlotStyleGetter","required","parseInt","_Fragment","trim","lessonsToAdd","toString","createdAt","timeSlot","validLessons","checkForExistingLesson","docRef","UserManagement","newUser","setNewUser","remainingLessons","split","searchTerm","setSearchTerm","filterMembership","setFilterMembership","isPopupOpen","setIsPopupOpen","editingUser","setEditingUser","users","setUsers","loadUsers","fetchedUsers","fetchUsers","handleError","handleDeleteUser","userId","deleteUser","user","resetForm","filteredUsers","updatedData","editUser","prevUsers","setDoc","addUser","EditableList","items","onDelete","item","ManagerPage","newLessonType","setNewLessonType","memberships","setMemberships","newMembership","setNewMembership","fetchLessonTypes","fetchMemberships","membershipsList","newType","newMembershipData","TestStatus","passed","failed","total","TestSuite","_suite$assertionResul","suite","isPassed","status","filePath","pop","assertionResults","_test$failureMessages","failureMessages","i","TestsScreen","_testResults$testResu","testResults","setTestResults","response","fetch","process","method","headers","json","ok","details","fillRule","clipRule","numTotalTests","numPassedTests","numFailedTests","ChartJS","register","CategoryScale","LinearScale","PointElement","LineElement","BarElement","ArcElement","Title","Tooltip","Legend","chartOptions","responsive","plugins","legend","position","AdminDashboard","stats","setStats","chartData","setChartData","pieChartData","setPieChartData","barChartData","setBarChartData","activeSection","setActiveSection","isDropdownOpen","setIsDropdownOpen","loadStats","loadChartData","loadPieChartData","loadBarChartData","fetchLogo","currentWeekStart","startOf","currentMonthStart","weeklyRegistrations","monthlyRegistrations","activeLessons","lessonDateTime","isSameOrAfter","monthlyData","Array","_","subtract","reverse","monthName","undefined","labels","datasets","values","borderColor","tension","usersSnapshot","membershipData","subscriptionType","borderWidth","settingsRef","logoDoc","_logoDoc$data","logoBase64","handleLogoUpload","file","files","reader","FileReader","onloadend","base64Logo","result","readAsDataURL","menuItems","icon","xmlns","strokeLinecap","strokeLinejoin","renderContent","accept","Line","options","Pie","Bar","TopNav","currentScreen","handleLogout","isMenuOpen","setIsMenuOpen","menuRef","useRef","handleClickOutside","contains","document","ref","handleMenuItemClick","itemId","AppContent","menuOpen","setMenuOpen","registeredUsers","setRegisteredUsers","screenComponents","home","schedule","profile","admin","settings","activeTab","App","ReactDOM","createRoot","getElementById","render","React","StrictMode"],"mappings":"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","file":"static/js/main.58a9fa81.chunk.js","sourcesContent":["import { initializeApp } from 'firebase/app';\r\nimport { getFirestore } from 'firebase/firestore';\r\nimport { getStorage } from 'firebase/storage';\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyBgRjJShNJqWB2nq931kKobLRHUeejW0vo\",\r\n  authDomain: \"milan-studio-b8b4b.firebaseapp.com\",\r\n  databaseURL: \"https://milan-studio-b8b4b-default-rtdb.europe-west1.firebasedatabase.app\",\r\n  projectId: \"milan-studio-b8b4b\",\r\n  storageBucket: \"milan-studio-b8b4b.firebasestorage.app\",\r\n  messagingSenderId: \"961084768524\",\r\n  appId: \"1:961084768524:web:2cdbc3a67dc018d8058929\",\r\n  measurementId: \"G-8XF83E9KQY\"\r\n};\r\n\r\nconst app = initializeApp(firebaseConfig);\r\nexport const db = getFirestore(app);\r\nexport const storage = getStorage(app);\r\n\r\n","import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport { db } from '../firebase';\r\nimport { doc, getDoc } from 'firebase/firestore';\r\n\r\n\r\nconst UserContext = createContext();\r\n\r\nexport const UserProvider = ({ children }) => {\r\n  const [userData, setUserData] = useState(null);\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n\r\n  const updateUserData = async (data) => {\r\n    try {\r\n      const userRef = doc(db, 'Users', data.phone);\r\n      const userDoc = await getDoc(userRef);\r\n\r\n      if (userDoc.exists()) {\r\n        const docData = userDoc.data();\r\n        setUserData({ ...docData, phone: data.phone, isAdmin: Boolean(docData.isAdmin) });\r\n        setIsLoggedIn(true);\r\n      } else {\r\n        console.error('User not found in Firebase');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching user data from Firebase:', error);\r\n    }\r\n  };\r\n\r\n  const refreshUserData = async (phone) => {\r\n    if (!phone) {\r\n      console.error('Cannot refresh user data: phone is undefined');\r\n      return;\r\n    }\r\n  \r\n    try {\r\n      const userRef = doc(db, 'Users', phone);\r\n      const userDoc = await getDoc(userRef);\r\n      if (userDoc.exists()) {\r\n        const data = userDoc.data();\r\n        setUserData({ ...data, phone });\r\n      } else {\r\n        console.error('User not found in Firebase');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error refreshing user data:', error);\r\n    }\r\n  };\r\n  \r\n\r\n  const logout = () => {\r\n    setUserData(null);\r\n    setIsLoggedIn(false);\r\n  };\r\n\r\n  return (\r\n    <UserContext.Provider value={{ \r\n      userData, \r\n      isLoggedIn, \r\n      updateUserData, \r\n      refreshUserData, // הוסף כאן את הפונקציה\r\n      logout \r\n    }}>\r\n      {children}\r\n    </UserContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useUser = () => useContext(UserContext);\r\n","import { createContext, useContext, useState } from \"react\";\r\n\r\nconst LogoContext = createContext(null);\r\n\r\n\r\n\r\nexport const LogoProvider = ({ children }) => {\r\n  const [logoUrl, setLogoUrl] = useState(\"https://your-default-logo-url.com/logo.png\");\r\n\r\n  return (\r\n    <LogoContext.Provider value={{ logoUrl, setLogoUrl }}>\r\n      {children}\r\n    </LogoContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useLogo = () => {\r\n  const context = useContext(LogoContext);\r\n  if (!context) {\r\n    throw new Error(\"useLogo must be used within a LogoProvider\");\r\n  }\r\n  return context;\r\n};\r\n","import React, { useState } from 'react';\nimport { getDoc, doc } from 'firebase/firestore';\nimport { db } from '../firebase';\nimport { useUser } from '../contexts/UserContext';\nimport { useLogo } from '../contexts/LogoContext';\nimport { validatePhone } from '../utils';\n\nconst LoginForm = ({ setCurrentScreen }) => {\n  const [phone, setPhone] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState('');\n  const { updateUserData } = useUser();\n  const { logoUrl, loading } = useLogo();\n  console.log(\"Logo URL:\", logoUrl); // Debugging\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  // Admin constants\n  const ADMIN = {\n    phone: '0500000000',\n    name: 'מנהל מערכת',\n    isAdmin: true,\n  };\n\n  // Handle phone input change\n  const handlePhoneChange = (e) => {\n    const value = e.target.value.replace(/[^0-9]/g, ''); // Allow only numbers\n    setPhone(value);\n    if (error) setError(''); // Clear error on input change\n  };\n\n  // Handle login submission\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    try {\n      if (!validatePhone(phone)) {\n        throw new Error('נא להזין מספר טלפון תקין בפורמט: 05XXXXXXXX');\n      }\n\n      if (phone === ADMIN.phone) {\n        updateUserData(ADMIN);\n        setCurrentScreen('admin');\n        setIsLoading(false);\n        return;\n      }\n\n      const userRef = doc(db, 'Users', phone);\n      const userDoc = await getDoc(userRef);\n\n      if (userDoc.exists()) {\n        const userData = {\n          phone,\n          ...userDoc.data(),\n          isAdmin: false,\n          registeredLessons: userDoc.data().registeredLessons || [],\n          completedLessons: userDoc.data().completedLessons || 0,\n          membershipType: userDoc.data().membershipType || 'רגיל',\n          joinDate: userDoc.data().joinDate || new Date().toISOString(),\n        };\n\n        updateUserData(userData);\n        setCurrentScreen('home');\n      } else if (phone === ADMIN.phone) {\n        setCurrentScreen('admin');\n      } else {\n        throw new Error('מספר טלפון לא נמצא במערכת');\n      }\n    } catch (err) {\n      console.error('Login error:', err);\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-green-50 flex items-center justify-center p-4\">\n      <div className=\"max-w-md w-full space-y-8 bg-white/90 backdrop-blur-sm rounded-xl p-8 shadow-lg\">\n        {/* Header */}\n        <div className=\"text-center\">\n          <div className=\"flex flex-col items-center mb-6\">\n             <img\n                src={logoUrl || \"/fallback-logo.png\"} // Use fallback if logoUrl is undefined\n                alt=\"Milan Pilates Logo\"\n                className=\"w-32 h-32 object-contain mb-4\"\n            />\n            <h1 className=\"text-3xl font-bold bg-gradient-to-r from-blue-600 to-blue-400 text-transparent bg-clip-text\">\n              Milan Pilates\n            </h1>\n            <span className=\"text-sm text-gray-500 mt-1\">By Isakov Team</span>\n          </div>\n          <h2 className=\"text-2xl font-semibold text-gray-900\">ברוכים הבאים</h2>\n          <p className=\"mt-2 text-gray-600\">\n            התחברו כדי להירשם לשיעורים ולנהל את האימונים שלכם\n          </p>\n        </div>\n\n        {/* Login Form */}\n        <form onSubmit={handleSubmit} className=\"mt-8 space-y-6\">\n          {error && (\n            <div className=\"bg-red-50 text-red-600 p-4 rounded-lg text-sm text-center\">\n              {error}\n            </div>\n          )}\n\n          <div>\n            <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n              מספר טלפון\n            </label>\n            <div className=\"relative\">\n              <span className=\"absolute right-3 top-3 text-gray-400\">📱</span>\n              <input\n                id=\"phone\"\n                type=\"tel\"\n                value={phone}\n                onChange={handlePhoneChange}\n                disabled={isLoading}\n                className=\"w-full pr-10 p-3 border border-gray-300 rounded-lg \n                         focus:ring-2 focus:ring-blue-200 focus:border-blue-400 \n                         outline-none transition-all disabled:opacity-50\"\n                placeholder=\"הזינו מספר טלפון\"\n                dir=\"ltr\"\n                maxLength={10}\n              />\n            </div>\n            <p className=\"mt-1 text-sm text-gray-500\">יש להזין מספר בפורמט: 05XXXXXXXX</p>\n          </div>\n\n          <button\n            type=\"submit\"\n            disabled={isLoading || !phone}\n            className=\"w-full p-3 bg-gradient-to-r from-blue-600 to-blue-500 \n                     text-white rounded-lg font-medium transition-all\n                     hover:from-blue-700 hover:to-blue-600 \n                     focus:outline-none focus:ring-2 focus:ring-blue-300\n                     disabled:opacity-50\"\n          >\n            {isLoading ? (\n              <div className=\"flex items-center justify-center\">\n                <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" fill=\"none\" viewBox=\"0 0 24 24\">\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n                </svg>\n                טוען...\n              </div>\n            ) : (\n              \"התחבר\"\n            )}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default LoginForm;\n","// פונקציה לעדכון סטייט בטפסים\r\nexport const updateFormState = (e, stateUpdater) => {\r\n    const { name, value, type, checked } = e.target;\r\n    stateUpdater((prev) => ({\r\n      ...prev,\r\n      [name]: type === 'checkbox' ? checked : value,\r\n    }));\r\n  };\r\n  \r\n  // פונקציה לטיפול בקריאת API עם Firebase\r\n  export const handleFirebaseOperation = async (operation, data, onSuccess, onError) => {\r\n    try {\r\n      const result = await operation(data);\r\n      onSuccess(result);\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      if (onError) onError(error);\r\n    }\r\n  };\r\n  \r\n  // פונקציה להצגת התראות בצורה אחידה\r\n  export const showAlert = (message) => {\r\n    alert(message);\r\n  };\r\n  \r\n  // Utility functions for date and lesson-related calculations\r\n// These functions can be reused across multiple components to avoid code duplication\r\n\r\n/**\r\n * Returns a greeting message based on the current hour of the day.\r\n * @returns {string} - Greeting message in Hebrew.\r\n */\r\nexport const getGreeting = () => {\r\n  const hour = new Date().getHours();\r\n  if (hour < 12) return 'בוקר טוב';\r\n  if (hour < 17) return 'צהריים טובים';\r\n  if (hour < 21) return 'ערב טוב';\r\n  return 'לילה טוב';\r\n};\r\n\r\n/**\r\n * Filters lessons that fall between a given start and end date.\r\n * @param {Array} lessons - List of lesson objects.\r\n * @param {Date} startDate - Start date for the filter.\r\n * @param {Date} endDate - End date for the filter.\r\n * @returns {Array} - Filtered list of lessons within the date range.\r\n */\r\nexport const filterLessonsByDate = (lessons, startDate, endDate) => {\r\n  return lessons?.filter((lesson) => {\r\n    const lessonDate = new Date(lesson.date);\r\n    return lessonDate >= startDate && lessonDate <= endDate;\r\n  }) || [];\r\n};\r\n\r\n/**\r\n * Calculates the number of weeks since a given start date.\r\n * @param {string} startDate - ISO string representing the start date.\r\n * @returns {number} - Number of weeks since the start date (minimum 1 week).\r\n */\r\nexport const calculateWeeksSinceDate = (startDate) => {\r\n  if (!startDate) return 1; // Default to 1 week if no start date is provided\r\n  const today = new Date();\r\n  const diffInMilliseconds = today - new Date(startDate);\r\n  const diffInWeeks = Math.ceil(diffInMilliseconds / (1000 * 60 * 60 * 24 * 7));\r\n  return diffInWeeks > 0 ? diffInWeeks : 1; // Ensure at least 1 week to avoid division by zero\r\n};\r\n\r\n/**\r\n * Calculates the total number of participants in a given set of lessons.\r\n * @param {Array} lessons - List of lesson objects.\r\n * @returns {number} - Total number of participants.\r\n */\r\nexport const calculateTotalParticipants = (lessons) => {\r\n  return lessons?.reduce((acc, lesson) => acc + (lesson.registeredParticipants || 0), 0);\r\n};\r\n\r\n/**\r\n * Validates an Israeli phone number format.\r\n * @param {string} phoneNumber - The phone number to validate.\r\n * @returns {boolean} - True if the phone number is valid, false otherwise.\r\n */\r\nexport const validatePhone = (phoneNumber) => {\r\n  const phoneRegex = /^05\\d{8}$/; // Match numbers starting with 05 followed by 8 digits\r\n  return phoneRegex.test(phoneNumber);\r\n};","import React from 'react';\r\nimport { useUser } from '../contexts/UserContext';\r\nimport { useLogo } from '../contexts/LogoContext';\r\n\r\nconst Home = () => {\r\n  const { userData } = useUser();\r\n  const { logoUrl } = useLogo();\r\n  const today = new Date();\r\n  today.setHours(0, 0, 0, 0);\r\n  const endOfWeek = new Date();\r\n  endOfWeek.setDate(today.getDate() + (7 - today.getDay()));\r\n\r\n  // פונקציה לברכה דינמית\r\n  const getGreeting = () => {\r\n    const hour = new Date().getHours();\r\n    if (hour < 12) return 'בוקר טוב';\r\n    if (hour < 17) return 'צהריים טובים';\r\n    if (hour < 21) return 'ערב טוב';\r\n    return 'לילה טוב';\r\n  };\r\n\r\n  // חישוב שיעורים קרובים\r\n  const calculateUpcomingLessons = () =>\r\n    userData?.registeredLessons?.filter((lesson) => {\r\n      const lessonDate = new Date(lesson.date);\r\n      return lessonDate >= today && lessonDate <= endOfWeek;\r\n    }) || [];\r\n\r\n  // חישוב שיעורים עברו\r\n  const calculatePastLessonsCount = () =>\r\n    userData?.registeredLessons?.filter((lesson) => {\r\n      const lessonDate = new Date(lesson.date);\r\n      return lessonDate < today;\r\n    }).length || 0;\r\n\r\n  // חישוב ממוצע שיעורים בשבוע\r\n  const calculateLessonsPerWeek = (pastLessonsCount) => {\r\n    const joinDate = userData?.joinDate ? new Date(userData.joinDate) : today;\r\n    const diffInMilliseconds = today - joinDate;\r\n    const diffInWeeks = Math.ceil(diffInMilliseconds / (1000 * 60 * 60 * 24 * 7));\r\n    return (pastLessonsCount / (diffInWeeks > 0 ? diffInWeeks : 1)).toFixed(2);\r\n  };\r\n\r\n  // נתוני חישוב\r\n  const upcomingLessons = calculateUpcomingLessons();\r\n  const pastLessonsCount = calculatePastLessonsCount();\r\n  const lessonsPerWeek = calculateLessonsPerWeek(pastLessonsCount);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* כותרת וברכה */}\r\n      <div className=\"text-center bg-white rounded-lg p-8 shadow-sm\">\r\n        <div className=\"logo-container\">\r\n          <img\r\n            src={logoUrl || '/default-logo.png'}\r\n            alt=\"Studio Logo\"\r\n            className=\"logo\"\r\n          />\r\n        </div>\r\n        <h1 className=\"text-2xl font-bold text-gray-800\">\r\n          {getGreeting()}, {userData?.name || 'אורח'}\r\n        </h1>\r\n        <p className=\"text-gray-600 mt-2\">\r\n          ברוכים הבאים למערכת השיעורים של Milan Pilates\r\n        </p>\r\n      </div>\r\n\r\n      {/* קופסאות מידע */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n        {/* שיעורים קרובים */}\r\n        <InfoBox title=\"השיעורים הקרובים שלך\">\r\n          {upcomingLessons.length > 0 ? (\r\n            <ul className=\"space-y-3\">\r\n              {upcomingLessons.map((lesson, index) => (\r\n                <LessonItem key={index} lesson={lesson} />\r\n              ))}\r\n            </ul>\r\n          ) : (\r\n            <p className=\"text-gray-500 text-center py-4\">\r\n              אין שיעורים קרובים השבוע\r\n            </p>\r\n          )}\r\n        </InfoBox>\r\n\r\n        {/* סטטיסטיקות */}\r\n        <InfoBox title=\"סטטיסטיקות\">\r\n          <Statistic label=\"שיעורים שהשתתפת\" value={pastLessonsCount} />\r\n          <Statistic label=\"כמות שיעורים עתידיים\" value={upcomingLessons.length} />\r\n          <Statistic label=\"ממוצע שיעורים בשבוע\" value={lessonsPerWeek} />\r\n        </InfoBox>\r\n\r\n        {/* פרטי מנוי */}\r\n        <InfoBox title=\"פרטי מנוי\">\r\n          <Detail label=\"סוג מנוי\" value={userData?.membershipType || 'רגיל'} />\r\n          <Detail label=\"תאריך הצטרפות\" value={userData?.joinDate || 'לא זמין'} />\r\n        </InfoBox>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// קומפוננטת פרטי מידע\r\nconst InfoBox = ({ title, children }) => (\r\n  <div className=\"bg-white rounded-lg p-6 shadow-sm\">\r\n    <h2 className=\"text-xl font-semibold mb-4\">{title}</h2>\r\n    {children}\r\n  </div>\r\n);\r\n\r\n// קומפוננטת שיעור\r\nconst LessonItem = ({ lesson }) => (\r\n  <li className=\"flex flex-col p-3 bg-gray-50 rounded-lg\">\r\n    <span className=\"font-bold text-gray-800\">שם השיעור: {lesson.title}</span>\r\n    <span className=\"text-gray-600\">סוג השיעור: {lesson.type || 'לא מוגדר'}</span>\r\n    <span className=\"text-gray-600\">\r\n      תאריך: {new Date(lesson.date).toLocaleDateString('he-IL')}\r\n    </span>\r\n    <span className=\"text-gray-600\">שעה: {lesson.time}</span>\r\n  </li>\r\n);\r\n\r\n// קומפוננטת סטטיסטיקה\r\nconst Statistic = ({ label, value }) => (\r\n  <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\r\n    <span className=\"text-gray-600\">{label}</span>\r\n    <span className=\"font-semibold\">{value}</span>\r\n  </div>\r\n);\r\n\r\n// קומפוננטת פרטים\r\nconst Detail = ({ label, value }) => (\r\n  <div className=\"p-3 bg-gray-50 rounded-lg\">\r\n    <span className=\"text-gray-600\">{label}: </span>\r\n    <span className=\"font-semibold\">{value}</span>\r\n  </div>\r\n);\r\n\r\nexport default Home;\r\n","import {\r\n  collection,\r\n  getDocs,\r\n  addDoc,\r\n  deleteDoc,\r\n  doc,\r\n  getDoc,\r\n  updateDoc,\r\n  setDoc, // הוספנו setDoc\r\n  arrayUnion,\r\n  arrayRemove,\r\n} from 'firebase/firestore';\r\nimport { db } from '../firebase';\r\n\r\n/**\r\n * Fetch all documents from a Firestore collection.\r\n * @param {string} collectionName - The name of the Firestore collection.\r\n * @returns {Promise<Array>} - A list of documents.\r\n */\r\nexport const fetchCollection = async (collectionName) => {\r\n  const querySnapshot = await getDocs(collection(db, collectionName));\r\n  return querySnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() }));\r\n};\r\n\r\n/**\r\n * Add a new document to a Firestore collection.\r\n * @param {string} collectionName - The name of the Firestore collection.\r\n * @param {Object} data - The data to add to the collection.\r\n * @returns {Promise<Object>} - The added document.\r\n */\r\nexport const addDocument = async (collectionName, data) => {\r\n  const newDoc = await addDoc(collection(db, collectionName), data);\r\n  return { id: newDoc.id, ...data };\r\n};\r\n\r\n/**\r\n * Delete a document from a Firestore collection.\r\n * @param {string} collectionName - The name of the Firestore collection.\r\n * @param {string} id - The ID of the document to delete.\r\n */\r\nexport const deleteDocument = async (collectionName, id) => {\r\n  await deleteDoc(doc(db, collectionName, id));\r\n};\r\n\r\n/**\r\n * Fetch a single document from a Firestore collection by ID.\r\n * @param {string} collectionName - The name of the Firestore collection.\r\n * @param {string} id - The ID of the document to fetch.\r\n * @returns {Promise<Object|null>} - The document data, or null if it doesn't exist.\r\n */\r\nexport const fetchDocumentById = async (collectionName, id) => {\r\n  const documentRef = doc(db, collectionName, id);\r\n  const documentSnapshot = await getDoc(documentRef);\r\n  return documentSnapshot.exists() ? { id, ...documentSnapshot.data() } : null;\r\n};\r\n\r\n/**\r\n * Fetch all lessons from the Lessons collection.\r\n * @returns {Promise<Array>} - List of lessons.\r\n */\r\nexport const fetchLessons = async () => {\r\n  const querySnapshot = await getDocs(collection(db, 'Lessons'));\r\n  return querySnapshot.docs.map((doc) => ({\r\n    id: doc.id,\r\n    ...doc.data(),\r\n  }));\r\n};\r\n\r\n/**\r\n * Fetch the registered lessons for a specific user.\r\n * @param {string} phone - The user's phone number.\r\n * @returns {Promise<Array>} - A list of registered lessons.\r\n */\r\nexport const getUserLessons = async (phone) => {\r\n  const userRef = doc(db, 'Users', phone);\r\n  const userSnap = await getDoc(userRef);\r\n\r\n  if (userSnap.exists()) {\r\n    return userSnap.data().registeredLessons || [];\r\n  }\r\n  return [];\r\n};\r\n\r\n/**\r\n * Update a lesson in the Lessons collection.\r\n * @param {string} lessonId - The ID of the lesson to update.\r\n * @param {Object} data - The data to update.\r\n */\r\nexport const updateLesson = async (lessonId, data) => {\r\n  const lessonRef = doc(db, 'Lessons', lessonId);\r\n  await updateDoc(lessonRef, data);\r\n};\r\n\r\n/**\r\n * Update a user in the Users collection.\r\n * @param {string} userId - The ID of the user to update.\r\n * @param {Object} data - The data to update.\r\n */\r\nexport const updateUser = async (userId, data) => {\r\n  const userRef = doc(db, 'Users', userId);\r\n  await updateDoc(userRef, data);\r\n};\r\n\r\n/**\r\n * Update lesson registration in Firestore.\r\n * @param {string} lessonId - The lesson ID.\r\n * @param {Object} userData - The user data.\r\n * @param {boolean} isRegistering - True for registering, False for canceling.\r\n */\r\nexport const updateLessonRegistration = async (lessonId, userData, isRegistering) => {\r\n  const lessonRef = doc(db, 'Lessons', lessonId);\r\n  const userRef = doc(db, 'Users', userData.phone);\r\n\r\n  const lessonUpdate = isRegistering\r\n    ? {\r\n        waitingList: arrayUnion(userData.phone),\r\n        registeredParticipants: (userData.registeredParticipants || 0) + 1,\r\n      }\r\n    : {\r\n        waitingList: arrayRemove(userData.phone),\r\n        registeredParticipants: Math.max((userData.registeredParticipants || 0) - 1, 0),\r\n      };\r\n\r\n  const userUpdate = isRegistering\r\n    ? {\r\n        registeredLessons: arrayUnion({\r\n          id: lessonId,\r\n          date: new Date().toISOString(), // Replace with actual date\r\n          type: 'Lesson Type', // Replace with actual type\r\n        }),\r\n      }\r\n    : {\r\n        registeredLessons: arrayRemove({\r\n          id: lessonId,\r\n          date: new Date().toISOString(),\r\n        }),\r\n      };\r\n\r\n  await updateDoc(lessonRef, lessonUpdate);\r\n  await updateDoc(userRef, userUpdate);\r\n};\r\n\r\n/**\r\n * Fetch all users from Firestore.\r\n * @returns {Promise<Array>} - List of users.\r\n */\r\nexport const fetchUsers = async () => {\r\n  const snapshot = await getDocs(collection(db, 'Users'));\r\n  return snapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() }));\r\n};\r\n\r\n/**\r\n * Add a new user to Firestore.\r\n * @param {Object} userData - User data to be added.\r\n */\r\nexport const addUser = async (userData) => {\r\n  const userRef = doc(db, 'Users', userData.phone);\r\n  await setDoc(userRef, userData);\r\n};\r\n\r\n/**\r\n * Edit a user's data in Firestore.\r\n * @param {string} userId - The user's ID.\r\n * @param {Object} updatedData - Updated user data.\r\n */\r\nexport const editUser = async (userId, updatedData) => {\r\n  const userRef = doc(db, 'Users', userId);\r\n  await updateDoc(userRef, updatedData);\r\n};\r\n\r\n/**\r\n * Delete a user from Firestore.\r\n * @param {string} userId - The user's ID.\r\n */\r\nexport const deleteUser = async (userId) => {\r\n  const userRef = doc(db, 'Users', userId);\r\n  await deleteDoc(userRef);\r\n};\r\n","import React from 'react';\r\n\r\n// Utility function to format date to \"Weekday, DD-MM-YYYY\"\r\nconst formatDateWithWeekday = (dateString) => {\r\n    const date = new Date(dateString);\r\n    const options = { weekday: 'long', day: '2-digit', month: '2-digit', year: 'numeric' };\r\n    return new Intl.DateTimeFormat('he-IL', options).format(date); // 'he-IL' formats in Hebrew locale\r\n  };\r\n  \r\n\r\nconst LessonCard = ({ lesson, isRegistered, onRegister, onCancel }) => {\r\n     // Format the lesson date\r\n  const formattedDate = formatDateWithWeekday(lesson.date);\r\n  return (\r\n  <div className=\"bg-white shadow-lg rounded-lg p-4 border border-gray-200 flex flex-col\">\r\n    <div className=\"text-lg font-semibold text-gray-800\">\r\n      {formattedDate}\r\n    </div>\r\n    <div className=\"text-lg font-semibold text-gray-800\">\r\n      {lesson.type} עם {lesson.instructor}\r\n    </div>\r\n    <div className=\"text-gray-600 mt-1\">שעה: {lesson.time}</div>\r\n    <div className=\"text-gray-600 mt-1\">\r\n      משתתפים מקסימליים: {lesson.maxParticipants}\r\n    </div>\r\n    <div className=\"text-gray-600 mt-1\">\r\n      משתתפים רשומים: {lesson.registeredParticipants}\r\n    </div>\r\n    <div className=\"text-gray-600 mt-1\">\r\n      מקומות פנויים: {lesson.maxParticipants - lesson.registeredParticipants}\r\n    </div>\r\n    {isRegistered ? (\r\n      <button\r\n        onClick={() => onCancel(lesson)}\r\n        className=\"mt-4 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600\"\r\n      >\r\n        בטל הרשמה\r\n      </button>\r\n    ) : (\r\n      <button\r\n        onClick={() => onRegister(lesson)}\r\n        className=\"mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600\"\r\n      >\r\n        הירשם לשיעור\r\n      </button>\r\n    )}\r\n  </div>\r\n);};\r\n\r\n\r\nexport default LessonCard;\r\n","import React from 'react';\r\n\r\n/**\r\n * Display an error message.\r\n * @param {string} message - The error message to display.\r\n */\r\nconst ErrorMessage = ({ message }) => (\r\n  <div\r\n    className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\"\r\n    role=\"alert\"\r\n  >\r\n    <span className=\"block sm:inline\">{message}</span>\r\n  </div>\r\n);\r\n\r\nexport default ErrorMessage;\r\n","import React, { useState, useEffect } from 'react';\nimport { useUser } from '../contexts/UserContext';\nimport { fetchLessons, updateLessonRegistration } from '../services/firebaseService';\nimport LessonCard from '../components/LessonCard';\nimport ErrorMessage from '../components/ErrorMessage';\n\nconst Schedule = () => {\n  const [classes, setClasses] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState('');\n  const { userData } = useUser();\n\n  useEffect(() => {\n    fetchClasses();\n  }, []);\n\n  const fetchClasses = async () => {\n    try {\n      const lessonsData = await fetchLessons();\n      const now = new Date();\n\n      const updatedLessons = lessonsData.map((lesson) => ({\n        ...lesson,\n        isActive: new Date(`${lesson.date} ${lesson.time}`) >= now,\n      }));\n\n      setClasses(updatedLessons.filter((lesson) => lesson.isActive));\n    } catch (error) {\n      setError('אירעה שגיאה בטעינת לוח השיעורים');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleRegister = async (lesson) => {\n    try {\n      await updateLessonRegistration(lesson.id, userData, true);\n      fetchClasses();\n    } catch (error) {\n      setError('אירעה שגיאה בהרשמה לשיעור');\n    }\n  };\n\n  const handleCancelRegistration = async (lesson) => {\n    try {\n      await updateLessonRegistration(lesson.id, userData, false);\n      fetchClasses();\n    } catch (error) {\n      setError('אירעה שגיאה בביטול ההרשמה לשיעור');\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto p-4\">\n      <h1 className=\"text-2xl font-bold mb-6\">לוח שיעורים</h1>\n      {error && <ErrorMessage message={error} />}\n      {isLoading ? (\n        <div className=\"text-center text-gray-500\">טוען...</div>\n      ) : (\n        classes.map((lesson) => (\n          <LessonCard\n            key={lesson.id}\n            lesson={lesson}\n            isRegistered={lesson.waitingList.includes(userData.phone)}\n            onRegister={handleRegister}\n            onCancel={handleCancelRegistration}\n          />\n        ))\n      )}\n    </div>\n  );\n};\n\nexport default Schedule;\n","import React from 'react';\r\n\r\n/**\r\n * Display a single lesson item.\r\n * @param {Object} lesson - The lesson data.\r\n */\r\nconst LessonItem = ({ lesson }) => (\r\n  <div className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\r\n    <div className=\"flex-1\">\r\n      <h3 className=\"font-bold text-lg\">{lesson.title || `${lesson.type} - ${lesson.instructor}`}</h3>\r\n      <p className=\"text-gray-600\">מדריך: {lesson.instructor}</p>\r\n      <p className=\"text-gray-600\">תאריך: {lesson.date}</p>\r\n      <p className=\"text-gray-600\">שעה: {lesson.time}</p>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default LessonItem;\r\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { useUser } from '../contexts/UserContext';\nimport { getUserLessons } from '../services/firebaseService';\nimport LessonItem from '../components/LessonItem';\nimport ErrorMessage from '../components/ErrorMessage';\n\nconst ProfileScreen = () => {\n  const { userData } = useUser();\n  const [registeredLessons, setRegisteredLessons] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState('');\n  const today = new Date();\n\n  // פונקציה לשליפת שיעורים\n  const fetchRegisteredLessons = useCallback(async () => {\n    try {\n      const lessons = await getUserLessons(userData.phone);\n      const futureLessons = lessons.filter((lesson) => new Date(lesson.date) > today);\n      setRegisteredLessons(futureLessons);\n    } catch (error) {\n      console.error('Error fetching registered lessons:', error);\n      setError('אירעה שגיאה בטעינת השיעורים');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [userData, today]);\n\n  // שליפת שיעורים על בסיס נתוני המשתמש\n  useEffect(() => {\n    if (userData?.phone) {\n      fetchRegisteredLessons();\n    }\n  }, [fetchRegisteredLessons]);\n\n  // אם אין נתוני משתמש\n  if (!userData) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"text-gray-500\">טוען...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto p-4 space-y-6\">\n      {error && <ErrorMessage message={error} />}\n\n      {/* User Information */}\n      <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n        <h1 className=\"text-2xl font-bold mb-6\">פרופיל משתמש</h1>\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\n            <span className=\"text-gray-600 ml-2\">👤</span>\n            <span className=\"text-gray-600\">שם: </span>\n            <span className=\"font-medium mr-2\">{userData.name}</span>\n          </div>\n          <div className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\n            <span className=\"text-gray-600 ml-2\">📱</span>\n            <span className=\"text-gray-600\">טלפון: </span>\n            <span className=\"font-medium mr-2\" dir=\"ltr\">{userData.phone}</span>\n          </div>\n          <div className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\n            <span className=\"text-gray-600 ml-2\">🛡️</span>\n            <span className=\"text-gray-600\">סוג משתמש: </span>\n            <span className=\"font-medium mr-2\">{userData.isAdmin ? 'מנהל' : 'משתמש רגיל'}</span>\n          </div>\n          <div className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\n            <span className=\"text-gray-600 ml-2\">🛡️</span>\n            <span className=\"text-gray-600\">סוג מנוי: </span>\n            <span className=\"font-medium mr-2\">{userData.membership || 'לא מוגדר'}</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Registered Lessons */}\n      <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n        <h2 className=\"text-xl font-bold mb-4\">השיעורים שנרשמת אליהם</h2>\n        {isLoading ? (\n          <p className=\"text-center text-gray-500 py-4\">טוען שיעורים...</p>\n        ) : registeredLessons.length > 0 ? (\n          <div className=\"space-y-4\">\n            {registeredLessons.map((lesson, index) => (\n              <LessonItem key={index} lesson={lesson} />\n            ))}\n          </div>\n        ) : (\n          <p className=\"text-center text-gray-500 py-4\">\n            לא נרשמת לשום שיעור\n          </p>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default ProfileScreen;\n","import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { db } from '../firebase'; // Ensure your Firebase setup is correct\r\nimport { collection, getDocs, deleteDoc, doc } from 'firebase/firestore';\r\n\r\nconst LessonsContext = createContext();\r\n\r\nexport const LessonsProvider = ({ children }) => {\r\n  const [lessons, setLessons] = useState([]);\r\n\r\n  // Fetch lessons from Firebase\r\n  useEffect(() => {\r\n    const fetchLessons = async () => {\r\n      try {\r\n        const lessonsCollection = collection(db, 'Lessons');\r\n        const lessonSnapshot = await getDocs(lessonsCollection);\r\n        const lessonList = lessonSnapshot.docs.map((doc) => ({\r\n          id: doc.id,\r\n          ...doc.data(),\r\n        }));\r\n        console.log(\"Fetched Lessons from Firestore:\", lessonList); // Debugging\r\n        setLessons(lessonList);\r\n      } catch (error) {\r\n        console.error('Error fetching lessons:', error);\r\n      }\r\n    };\r\n    fetchLessons();\r\n  }, []);\r\n\r\n  // Add a lesson (local state only)\r\n  const addLesson = (lesson) => {\r\n    setLessons((prev) => [...prev, lesson]);\r\n  };\r\n\r\n  // Remove a single lesson from Firebase\r\n  const removeLesson = async (lessonId) => {\r\n    if (!lessonId) {\r\n      console.error('Invalid lessonId:', lessonId);\r\n      return;\r\n    }\r\n    try {\r\n      await deleteDoc(doc(db, 'Lessons', lessonId));\r\n      setLessons((prev) => prev.filter((lesson) => lesson.id !== lessonId));\r\n    } catch (error) {\r\n      console.error('Error removing lesson:', error);\r\n    }\r\n  };\r\n\r\n  // Clear all lessons from Firebase\r\n  const clearAllLessons = async () => {\r\n    const lessonsCollection = collection(db, 'Lessons');\r\n    const lessonSnapshot = await getDocs(lessonsCollection);\r\n    const batchDelete = lessonSnapshot.docs.map((lessonDoc) =>\r\n      deleteDoc(doc(db, 'Lessons', lessonDoc.id))\r\n    );\r\n    await Promise.all(batchDelete);\r\n    setLessons([]);\r\n  };\r\n\r\n  return (\r\n    <LessonsContext.Provider value={{ lessons, addLesson, removeLesson, clearAllLessons }}>\r\n      {children}\r\n    </LessonsContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useLessons = () => {\r\n  return useContext(LessonsContext);\r\n};","import React, { useState, useEffect } from 'react';\r\nimport { useLessons } from '../contexts/LessonsContext';\r\nimport { Calendar, momentLocalizer } from 'react-big-calendar';\r\nimport { collection, getDocs, addDoc, query, orderBy } from 'firebase/firestore';\r\nimport { db } from '../firebase';\r\nimport moment from 'moment';\r\nimport 'react-big-calendar/lib/css/react-big-calendar.css';\r\n\r\nconst localizer = momentLocalizer(moment);\r\n\r\nconst useIsMobile = () => {\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 1024);\r\n\r\n  useEffect(() => {\r\n    const handleResize = () => setIsMobile(window.innerWidth < 1024);\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  return isMobile;\r\n};\r\n\r\nconst LessonManagement = () => {\r\n  const { lessons, addLesson, removeLesson, clearAllLessons } = useLessons();\r\n  const [lessonTypes, setLessonTypes] = useState([]);\r\n  const isMobile = useIsMobile();\r\n  const [selectedTimes, setSelectedTimes] = useState([]);\r\n  const [showForm, setShowForm] = useState(false);\r\n  const [showHistory, setShowHistory] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    instructor: '',\r\n    type: '',\r\n    maxParticipants: 0,\r\n    date: '',\r\n    time: '',\r\n  });\r\n\r\n  // Fetch both lesson types and lessons\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n\r\n    const fetchData = async () => {\r\n      try {\r\n        // Fetch lesson types\r\n        const typesSnapshot = await getDocs(collection(db, 'LessonTypes'));\r\n        if (!isMounted) return;\r\n        \r\n        const types = typesSnapshot.docs.map((doc) => ({\r\n          id: doc.id,\r\n          ...doc.data(),\r\n        }));\r\n        setLessonTypes(types);\r\n\r\n        // Fetch ALL lessons\r\n        const lessonsRef = collection(db, 'Lessons');\r\n        const lessonsSnapshot = await getDocs(lessonsRef);\r\n        if (!isMounted) return;\r\n\r\n        // Add new lessons only if they don't exist in context\r\n        const fetchedLessons = lessonsSnapshot.docs.map(doc => {\r\n          const lesson = {\r\n            id: doc.id,\r\n            ...doc.data()\r\n          };\r\n          console.log('Fetched lesson:', {\r\n            id: lesson.id,\r\n            date: lesson.date,\r\n            time: lesson.time,\r\n            isActive: lesson.isActive,\r\n            type: lesson.type\r\n          });\r\n          return lesson;\r\n        });\r\n\r\n        console.log('Current lessons in context:', lessons.map(l => ({\r\n          id: l.id,\r\n          date: l.date,\r\n          time: l.time,\r\n          isActive: l.isActive,\r\n          type: l.type\r\n        })));\r\n\r\n        // Get existing lesson IDs\r\n        const existingLessonIds = lessons.map(lesson => lesson.id);\r\n\r\n        // Only add lessons that don't already exist in context\r\n        fetchedLessons.forEach(lesson => {\r\n          if (lesson.id && !existingLessonIds.includes(lesson.id)) {\r\n            console.log('Adding new lesson to context:', {\r\n              id: lesson.id,\r\n              date: lesson.date,\r\n              time: lesson.time,\r\n              isActive: lesson.isActive,\r\n              type: lesson.type\r\n            });\r\n            addLesson(lesson);\r\n          }\r\n        });\r\n\r\n        // Log final state\r\n        console.log('Total lessons after update:', lessons.length);\r\n        console.log('Active lessons:', lessons.filter(l => l.isActive).length);\r\n        console.log('Historical lessons:', lessons.filter(l => !l.isActive).length);\r\n\r\n      } catch (error) {\r\n        console.error('Error fetching data:', error);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n\r\n    return () => {\r\n      isMounted = false;\r\n    };\r\n  }, [lessons]);\r\n\r\n  // Separate current and past lessons based on isActive flag\r\n  const { currentLessons, pastLessons } = lessons.reduce(\r\n    (acc, lesson) => {\r\n      if (lesson.isActive) {\r\n        acc.currentLessons.push(lesson);\r\n      } else {\r\n        acc.pastLessons.push(lesson);\r\n      }\r\n      return acc;\r\n    },\r\n    { currentLessons: [], pastLessons: [] }\r\n  );\r\n\r\n  // Group lessons by date for mobile view\r\n  const groupLessonsByDate = (lessonList) => {\r\n    return lessonList.reduce((acc, lesson) => {\r\n      const date = lesson.date;\r\n      if (!acc[date]) {\r\n        acc[date] = [];\r\n      }\r\n      acc[date].push(lesson);\r\n      return acc;\r\n    }, {});\r\n  };\r\n\r\n  const currentLessonsByDate = groupLessonsByDate(currentLessons);\r\n  const pastLessonsByDate = groupLessonsByDate(pastLessons);\r\n\r\n  const handleSelectSlot = ({ start, end }) => {\r\n    // Check if the selected time is in the past\r\n    if (!moment(start).isAfter(moment())) {\r\n      alert('לא ניתן להוסיף שיעורים בתאריכים שעברו');\r\n      return;\r\n    }\r\n\r\n    const newSelection = [];\r\n    let current = new Date(start);\r\n    while (current < end) {\r\n      const nextHour = new Date(current);\r\n      nextHour.setHours(current.getHours() + 1);\r\n      newSelection.push({ start: current, end: nextHour });\r\n      current = nextHour;\r\n    }\r\n    setSelectedTimes((prev) => {\r\n      const updatedSelection = prev.filter(\r\n        (slot) =>\r\n          !newSelection.some(\r\n            (newSlot) => newSlot.start.getTime() === slot.start.getTime()\r\n          )\r\n      );\r\n      return [\r\n        ...updatedSelection,\r\n        ...newSelection.filter(\r\n          (newSlot) =>\r\n            !prev.some((slot) => slot.start.getTime() === newSlot.start.getTime())\r\n        ),\r\n      ];\r\n    });\r\n  };\r\n\r\n  const handleAddLessons = async () => {\r\n    if (\r\n      formData.instructor.trim() === '' ||\r\n      formData.type.trim() === '' ||\r\n      formData.maxParticipants <= 0 ||\r\n      (isMobile && (formData.date === '' || formData.time === ''))\r\n    ) {\r\n      alert('אנא מלא את כל השדות בטופס');\r\n      return;\r\n    }\r\n\r\n    // Check for existing lessons at the same time\r\n    const checkForExistingLesson = (date, time) => {\r\n      return lessons.some(\r\n        (lesson) => lesson.date === date && lesson.time === time\r\n      );\r\n    };\r\n\r\n    const lessonsToAdd = isMobile\r\n      ? [\r\n          {\r\n            date: formData.date,\r\n            time: formData.time,\r\n            instructor: formData.instructor,\r\n            type: formData.type,\r\n            maxParticipants: formData.maxParticipants.toString(),\r\n            registeredParticipants: 0,\r\n            createdAt: moment().toISOString(),\r\n            title: `${formData.type} - ${formData.instructor}`,\r\n            isActive: moment(`${formData.date}T${formData.time}`).isAfter(moment()),\r\n            waitingList: [],\r\n          },\r\n        ]\r\n      : selectedTimes.map((timeSlot) => {\r\n          const date = moment(timeSlot.start).format('YYYY-MM-DD');\r\n          const time = moment(timeSlot.start).format('HH:mm');\r\n          return {\r\n            date,\r\n            time,\r\n            instructor: formData.instructor,\r\n            type: formData.type,\r\n            maxParticipants: formData.maxParticipants.toString(),\r\n            registeredParticipants: 0,\r\n            createdAt: moment().toISOString(),\r\n            title: `${formData.type} - ${formData.instructor}`,\r\n            isActive: true,\r\n            waitingList: [],\r\n          };\r\n        });\r\n\r\n    try {\r\n      // Filter out any time slots that already have lessons\r\n      const validLessons = lessonsToAdd.filter(\r\n        (lesson) => !checkForExistingLesson(lesson.date, lesson.time)\r\n      );\r\n\r\n      if (validLessons.length === 0) {\r\n        alert('כל השעות שנבחרו כבר תפוסות');\r\n        return;\r\n      }\r\n\r\n      if (validLessons.length < lessonsToAdd.length) {\r\n        alert('חלק מהשעות שנבחרו כבר תפוסות. רק השעות הפנויות יתווספו.');\r\n      }\r\n\r\n      for (const lesson of validLessons) {\r\n        const docRef = await addDoc(collection(db, 'Lessons'), lesson);\r\n        console.log('Added new lesson:', { id: docRef.id, ...lesson });\r\n        addLesson({ id: docRef.id, ...lesson });\r\n      }\r\n\r\n      // Reset form and selection only after successful add\r\n      setSelectedTimes([]);\r\n      setFormData({\r\n        instructor: '',\r\n        type: '',\r\n        maxParticipants: 0,\r\n        date: '',\r\n        time: '',\r\n      });\r\n      setShowForm(false);\r\n    } catch (error) {\r\n      console.error('Error adding lessons:', error);\r\n      alert('אירעה שגיאה בהוספת השיעורים');\r\n    }\r\n  };\r\n\r\n  const handleDeleteLesson = (lesson) => {\r\n    if (!lesson.isActive) {\r\n      alert('לא ניתן למחוק שיעורים שכבר התקיימו');\r\n      return;\r\n    }\r\n\r\n    if (window.confirm('האם אתה בטוח שברצונך למחוק את השיעור?')) {\r\n      removeLesson(lesson.id);\r\n    }\r\n  };\r\n\r\n  const handleClearAllLessons = () => {\r\n    if (window.confirm('האם אתה בטוח שברצונך למחוק את כל השיעורים העתידיים?')) {\r\n      // Only clear future lessons\r\n      currentLessons.forEach(lesson => removeLesson(lesson.id));\r\n    }\r\n  };\r\n\r\n  // Include all lessons in events, using isActive flag\r\n  const events = lessons\r\n    .sort((a, b) => moment(`${a.date}T${a.time}`).diff(moment(`${b.date}T${b.time}`)))\r\n    .map((lesson) => {\r\n      if (!lesson.id) {\r\n        console.error(\"Lesson ID is missing:\", lesson);\r\n        return null;\r\n      }\r\n      const lessonStart = new Date(`${lesson.date}T${lesson.time}`);\r\n      const lessonEnd = new Date(lessonStart);\r\n      lessonEnd.setMinutes(lessonEnd.getHours() +35);\r\n\r\n      return {\r\n        id: lesson.id,\r\n        title: `${lesson.type} - ${lesson.instructor}`,\r\n        start: lessonStart,\r\n        end: lessonEnd,\r\n        isPast: !lesson.isActive,\r\n        lesson: lesson,\r\n      };\r\n    })\r\n    .filter(Boolean);\r\n\r\n  const timeSlotStyleGetter = (value) => {\r\n    const isSelected = selectedTimes.some(\r\n      ({ start }) => start.getTime() === value.getTime()\r\n    );\r\n    return {\r\n      style: {\r\n        backgroundColor: isSelected ? '#cce5ff' : 'white',\r\n        border: isSelected ? '2px solid #007bff' : '1px solid #ccc',\r\n        height: '30px',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n      },\r\n    };\r\n  };\r\n\r\n  const eventStyleGetter = (event) => {\r\n    if (event.isPast) {\r\n      return {\r\n        style: {\r\n          backgroundColor: '#E5E7EB', // Gray background\r\n          color: '#4B5563', // Dark text\r\n          border: '1px solid #D1D5DB',\r\n          borderLeft: '4px solid #9CA3AF',\r\n          opacity: 0.85,\r\n          cursor: 'default',\r\n        },\r\n      };\r\n    }\r\n    return {\r\n      style: {\r\n        backgroundColor: '#93C5FD',\r\n        color: '#1E3A8A',\r\n        border: '1px solid #60A5FA',\r\n        borderLeft: '4px solid #3B82F6',\r\n      },\r\n    };\r\n  };\r\n  \r\n\r\n  const LessonCard = ({ lesson, isPast }) => (\r\n    <div\r\n      className={`bg-white shadow-lg rounded-lg p-4 border ${\r\n        isPast ? 'border-gray-300 opacity-70' : 'border-gray-200'\r\n      } flex flex-col`}\r\n    >\r\n      <div className=\"text-lg font-semibold text-gray-800\">\r\n        {lesson.type} עם {lesson.instructor}\r\n      </div>\r\n      <div className=\"text-gray-600 mt-1\">\r\n        שעה: {lesson.time}\r\n      </div>\r\n      {!isPast && (\r\n        <button\r\n          onClick={() => handleDeleteLesson(lesson)}\r\n          className=\"mt-4 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600\"\r\n        >\r\n          מחק\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-4\">\r\n      <h1 className=\"text-xl font-bold mb-4\">ניהול שיעורים</h1>\r\n      \r\n      {!isMobile ? (\r\n        <div className=\"mb-4 flex justify-end space-x-4\">\r\n          <button\r\n            onClick={handleClearAllLessons}\r\n            className=\"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600\"\r\n          >\r\n            מחק את כל השיעורים העתידיים\r\n          </button>\r\n          <button\r\n            onClick={() => setShowForm(true)}\r\n            className=\"px-4 py-2 bg-blue-500 text-white rounded-lg\"\r\n          >\r\n            הגדר שיעור\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <div className=\"mb-4 space-y-2\">\r\n          <button\r\n            onClick={() => setShowForm(true)}\r\n            className=\"w-full px-4 py-2 bg-blue-500 text-white rounded-lg\"\r\n          >\r\n            הגדר שיעור\r\n          </button>\r\n          <button\r\n            onClick={() => setShowHistory(!showHistory)}\r\n            className=\"w-full px-4 py-2 bg-gray-500 text-white rounded-lg\"\r\n          >\r\n            {showHistory ? 'הצג שיעורים עתידיים' : 'הצג היסטוריית שיעורים'}\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {isMobile ? (\r\n        <div>\r\n          <div className=\"mb-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <h2 className=\"text-lg font-semibold\">\r\n                {showHistory ? 'היסטוריית שיעורים' : 'שיעורים קרובים'}\r\n              </h2>\r\n              <span className=\"text-sm text-gray-500\">\r\n                {showHistory \r\n                  ? `${Object.keys(pastLessonsByDate).length} ימים` \r\n                  : `${Object.keys(currentLessonsByDate).length} ימים`}\r\n              </span>\r\n            </div>\r\n          </div>\r\n          \r\n          {showHistory ? (\r\n            // Past lessons (History)\r\n            Object.keys(pastLessonsByDate)\r\n              .sort((a, b) => moment(b).diff(moment(a)))\r\n              .map((date) => (\r\n                <div key={date} className=\"mb-6 bg-gray-50 p-4 rounded-lg\">\r\n                  <h3 className=\"text-lg font-semibold mb-2 text-gray-700\">\r\n                    {moment(date).format('DD/MM/YYYY')}\r\n                  </h3>\r\n                  <div className=\"grid grid-cols-1 gap-4\">\r\n                    {pastLessonsByDate[date]\r\n                      ?.sort((a, b) => moment(`${a.date}T${a.time}`).diff(moment(`${b.date}T${b.time}`)))\r\n                      .map((lesson) => (\r\n                        <LessonCard key={lesson.id} lesson={lesson} isPast={true} />\r\n                      ))}\r\n                  </div>\r\n                </div>\r\n              ))\r\n          ) : (\r\n            // Current lessons\r\n            Object.keys(currentLessonsByDate)\r\n              .sort((a, b) => moment(a).diff(moment(b)))\r\n              .map((date) => (\r\n                <div key={date} className=\"mb-6 bg-blue-50 p-4 rounded-lg\">\r\n                  <h3 className=\"text-lg font-semibold mb-2 text-blue-900\">\r\n                    {moment(date).format('DD/MM/YYYY')}\r\n                  </h3>\r\n                  <div className=\"grid grid-cols-1 gap-4\">\r\n                    {currentLessonsByDate[date]\r\n                      ?.sort((a, b) => moment(`${a.date}T${a.time}`).diff(moment(`${b.date}T${b.time}`)))\r\n                      .map((lesson) => (\r\n                        <LessonCard key={lesson.id} lesson={lesson} isPast={false} />\r\n                      ))}\r\n                  </div>\r\n                </div>\r\n              ))\r\n          )}\r\n          \r\n          {((showHistory && Object.keys(pastLessonsByDate).length === 0) ||\r\n            (!showHistory && Object.keys(currentLessonsByDate).length === 0)) && (\r\n            <div className=\"text-center py-8 text-gray-500\">\r\n              {showHistory ? 'אין שיעורים בהיסטוריה' : 'אין שיעורים קרובים'}\r\n            </div>\r\n          )}\r\n        </div>\r\n      ) : (\r\n        <Calendar\r\n          localizer={localizer}\r\n          selectable\r\n          onSelectSlot={handleSelectSlot}\r\n          events={events}\r\n          style={{\r\n            height: 'calc(100vh - 200px)',\r\n            width: '100%',\r\n            fontSize: '8px',\r\n          }}\r\n          defaultView=\"week\"\r\n          views={['month', 'week', 'day']}\r\n          step={60}\r\n          timeslots={1}\r\n          min={new Date(1970, 1, 1, 8, 0, 0)}\r\n          max={new Date(1970, 1, 1, 23, 0, 0)}\r\n          messages={{\r\n            month: 'חודש',\r\n            week: 'שבוע',\r\n            day: 'יום',\r\n            today: 'היום',\r\n            previous: 'קודם',\r\n            next: 'הבא',\r\n          }}\r\n          eventPropGetter={(event) => {\r\n            const isSelected = selectedTimes.some(\r\n              (time) => time.start.getTime() === event.start.getTime()\r\n            );\r\n            return{\r\n            style: {\r\n              backgroundColor: isSelected ? '#cce5ff' : '#93C5FD',\r\n              color: '#1E3A8A',\r\n              border: '1px solid #60A5FA',\r\n              borderLeft: '1px solid #3B82F6',\r\n              display: 'flex-inline',\r\n              flexDirection: 'column',\r\n              justifyContent: 'space-between',\r\n              padding: '1px',\r\n              marginLeft: '5px',\r\n            },\r\n          };}}\r\n          components={{\r\n            event: ({ event }) => (\r\n              <div\r\n                style={{\r\n                  display: 'flex',\r\n                  gap: '5px',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center',\r\n                  width: '100%',\r\n                  padding: '2px 4px',\r\n                }}\r\n              >\r\n                <strong>{event.title}</strong>\r\n                {event.lesson?.isActive && (\r\n                  <button\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleDeleteLesson(event.lesson);\r\n                    }}\r\n                    className=\"bg-red-500 text-white  px-2 py-1 rounded hover:bg-red-600\"\r\n                  >\r\n                    מחק\r\n                  </button>\r\n                )}\r\n              </div>\r\n            ),\r\n            timeSlotWrapper: ({ children, value }) => {\r\n              const styleProps = timeSlotStyleGetter(value);\r\n              return <div style={styleProps.style}>{children}</div>;\r\n            },\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {showForm && (\r\n        <div className=\"fixed inset-0 bg-gray-800 bg-opacity-75 flex justify-center items-center\">\r\n          <div className=\"bg-white p-6 rounded-lg shadow-lg max-w-md w-full mx-4\">\r\n            <h2 className=\"text-lg font-bold mb-4\">הוסף שיעור</h2>\r\n            <div className=\"mb-4\">\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"שם המדריך\"\r\n                value={formData.instructor}\r\n                onChange={(e) =>\r\n                  setFormData({ ...formData, instructor: e.target.value })\r\n                }\r\n                className=\"w-full p-2 border rounded-lg\"\r\n                required\r\n              />\r\n            </div>\r\n            <div className=\"mb-4\">\r\n              <select\r\n                value={formData.type}\r\n                onChange={(e) =>\r\n                  setFormData({ ...formData, type: e.target.value })\r\n                }\r\n                className=\"w-full p-2 border rounded-lg\"\r\n              >\r\n                <option value=\"\" disabled>\r\n                  בחר סוג שיעור\r\n                </option>\r\n                {lessonTypes.map((type) => (\r\n                  <option key={type.id} value={type.type}>\r\n                    {type.type}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            <div className=\"mb-4\">\r\n              <input\r\n                type=\"number\"\r\n                placeholder=\"מספר משתתפים מקסימלי\"\r\n                value={formData.maxParticipants}\r\n                onChange={(e) =>\r\n                  setFormData({\r\n                    ...formData,\r\n                    maxParticipants: parseInt(e.target.value) || 0\r\n                  })\r\n                }\r\n                className=\"w-full p-2 border rounded-lg\"\r\n                min=\"1\"\r\n                required\r\n              />\r\n            </div>\r\n            {isMobile && (\r\n              <>\r\n                <div className=\"mb-4\">\r\n                  <input\r\n                    type=\"date\"\r\n                    placeholder=\"תאריך השיעור\"\r\n                    value={formData.date}\r\n                    onChange={(e) =>\r\n                      setFormData({ ...formData, date: e.target.value })\r\n                    }\r\n                    min={moment().format('YYYY-MM-DD')}\r\n                    className=\"w-full p-2 border rounded-lg\"\r\n                    required\r\n                  />\r\n                </div>\r\n                <div className=\"mb-4\">\r\n                  <input\r\n                    type=\"time\"\r\n                    placeholder=\"שעת השיעור\"\r\n                    value={formData.time}\r\n                    onChange={(e) =>\r\n                      setFormData({ ...formData, time: e.target.value })\r\n                    }\r\n                    className=\"w-full p-2 border rounded-lg\"\r\n                    required\r\n                  />\r\n                </div>\r\n              </>\r\n            )}\r\n            <div className=\"flex justify-end space-x-2\">\r\n              <button\r\n                onClick={() => setShowForm(false)}\r\n                className=\"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600\"\r\n              >\r\n                ביטול\r\n              </button>\r\n              <button\r\n                onClick={handleAddLessons}\r\n                className=\"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600\"\r\n              >\r\n                הוסף\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LessonManagement;","import React, { useState, useEffect } from 'react';\r\nimport { fetchUsers, addUser, editUser, deleteUser } from '../services/firebaseService';\r\nimport { useUser } from '../contexts/UserContext';\r\n\r\nconst UserManagement = () => {\r\n  const [newUser, setNewUser] = useState({\r\n    name: '',\r\n    phone: '',\r\n    isAdmin: false,\r\n    membership: '',\r\n    remainingLessons: 0,\r\n    registeredLessons: [],\r\n    completedLessons: 0,\r\n    joinDate: new Date().toISOString().split('T')[0],\r\n  });\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filterMembership, setFilterMembership] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [isPopupOpen, setIsPopupOpen] = useState(false);\r\n  const [editingUser, setEditingUser] = useState(null);\r\n  const [users, setUsers] = useState([])|| {};\r\n  const { refreshUserData } = useUser() || {};\r\n\r\n  useEffect(() => {\r\n    loadUsers();\r\n  }, []);\r\n\r\n  const loadUsers = async () => {\r\n    try {\r\n      const fetchedUsers = await fetchUsers();\r\n      setUsers(fetchedUsers);\r\n    } catch (err) {\r\n      handleError('שגיאה בטעינת המשתמשים');\r\n    }\r\n  };\r\n\r\n  const handleError = (message) => {\r\n    console.error(message);\r\n    setError(message);\r\n  };\r\n\r\n  const handleAddUser = async () => {\r\n    if (!newUser.name || !newUser.phone || !newUser.membership) {\r\n      handleError('אנא מלא את כל השדות החובה');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await addUser(newUser);\r\n      setUsers((prev) => [...prev, { id: newUser.phone, ...newUser }]);\r\n      setIsPopupOpen(false);\r\n      setError('');\r\n      resetForm();\r\n    } catch (err) {\r\n      handleError('שגיאה בהוספת המשתמש');\r\n    }\r\n  };\r\n\r\n  const handleEditUser = async () => {\r\n    if (!editingUser.name || !editingUser.phone || !editingUser.membership) {\r\n      setError('אנא מלא את כל השדות החובה');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await editUser(editingUser.id, editingUser);\r\n\r\n      setUsers((prevUsers) =>\r\n        prevUsers.map((user) =>\r\n          user.id === editingUser.id ? { ...editingUser } : user\r\n        )\r\n      );\r\n\r\n      setEditingUser(null);\r\n      setIsPopupOpen(false);\r\n      setError('');\r\n    } catch (error) {\r\n      console.error('Error editing user:', error);\r\n      setError('שגיאה בעדכון המשתמש');\r\n    }\r\n  };\r\n\r\n  const handleDeleteUser = async (userId) => {\r\n    if (!window.confirm('האם אתה בטוח שברצונך למחוק את המשתמש?')) return;\r\n\r\n    try {\r\n      await deleteUser(userId);\r\n      setUsers((prev) => prev.filter((user) => user.id !== userId));\r\n    } catch (err) {\r\n      handleError('שגיאה במחיקת המשתמש');\r\n    }\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setNewUser({\r\n      name: '',\r\n      phone: '',\r\n      isAdmin: false,\r\n      membership: '',\r\n      remainingLessons: 0,\r\n      registeredLessons: [],\r\n      completedLessons: 0,\r\n      joinDate: new Date().toISOString().split('T')[0],\r\n    });\r\n  };\r\n\r\n  const filteredUsers = users.filter(\r\n    (user) =>\r\n      (!searchTerm || user.name.includes(searchTerm) || user.phone.includes(searchTerm)) &&\r\n      (!filterMembership || user.membership === filterMembership)\r\n  );\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto space-y-6\">\r\n      <div className=\"flex flex-col sm:flex-row justify-between items-center mb-4\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"חפש לפי שם או טלפון\"\r\n          value={searchTerm}\r\n          onChange={(e) => setSearchTerm(e.target.value)}\r\n          className=\"p-2 border rounded-lg w-full sm:w-1/2 mb-2 sm:mb-0\"\r\n        />\r\n        <button\r\n          onClick={() => {\r\n            resetForm();\r\n            setIsPopupOpen(true);\r\n          }}\r\n          className=\"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 mb-4 w-full sm:w-auto\"\r\n        >\r\n          הוסף משתמש\r\n        </button>\r\n      </div>\r\n      <div className=\"bg-white rounded-lg p-4 shadow-sm\">\r\n        <h2 className=\"text-lg font-bold mb-4\">רשימת משתמשים</h2>\r\n        <ul className=\"space-y-3\">\r\n          {filteredUsers.map((user) => (\r\n            <li key={user.id} className=\"flex justify-between items-center p-3 rounded-md bg-gray-100\">\r\n              <div>\r\n                <p>{user.name}</p>\r\n                <p>{user.phone}</p>\r\n              </div>\r\n              <div>\r\n                <button\r\n                  onClick={() => {\r\n                    setEditingUser(user);\r\n                    setIsPopupOpen(true);\r\n                  }}\r\n                  className=\"bg-yellow-500 text-white px-3 py-1 rounded-md hover:bg-yellow-600\"\r\n                >\r\n                  ערוך\r\n                </button>\r\n                <button\r\n                  onClick={() => handleDeleteUser(user.id)}\r\n                  className=\"bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600\"\r\n                >\r\n                  מחק\r\n                </button>\r\n              </div>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n\r\n      {isPopupOpen && (\r\n        <div className=\"fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center\">\r\n          <div className=\"bg-white p-4 rounded-lg shadow-lg max-w-md w-full\">\r\n            <h2 className=\"text-lg font-bold mb-4\">\r\n              {editingUser ? 'ערוך משתמש' : 'הוסף משתמש'}\r\n            </h2>\r\n            {error && (\r\n              <div className=\"bg-red-50 text-red-600 p-3 rounded-lg mb-4\">\r\n                {error}\r\n              </div>\r\n            )}\r\n            <div className=\"space-y-3\">\r\n              <input\r\n                type=\"text\"\r\n                name=\"name\"\r\n                placeholder=\"שם מלא\"\r\n                value={editingUser ? editingUser.name : newUser.name}\r\n                onChange={(e) =>\r\n                  editingUser\r\n                    ? setEditingUser((prev) => ({ ...prev, name: e.target.value }))\r\n                    : setNewUser((prev) => ({ ...prev, name: e.target.value }))\r\n                }\r\n                className=\"w-full p-2 border rounded-md\"\r\n              />\r\n              <input\r\n                type=\"tel\"\r\n                name=\"phone\"\r\n                placeholder=\"טלפון\"\r\n                value={editingUser ? editingUser.phone : newUser.phone}\r\n                onChange={(e) =>\r\n                  editingUser\r\n                    ? setEditingUser((prev) => ({ ...prev, phone: e.target.value }))\r\n                    : setNewUser((prev) => ({ ...prev, phone: e.target.value }))\r\n                }\r\n                className=\"w-full p-2 border rounded-md\"\r\n              />\r\n              <select\r\n                name=\"membership\"\r\n                value={editingUser ? editingUser.membership : newUser.membership}\r\n                onChange={(e) => {\r\n                  const value = e.target.value;\r\n                  if (editingUser) {\r\n                    setEditingUser((prev) => ({\r\n                      ...prev,\r\n                      membership: value,\r\n                    }));\r\n                  } else {\r\n                    setNewUser((prev) => ({ ...prev, membership: value }));\r\n                  }\r\n                }}\r\n                className=\"w-full p-2 border rounded-md\"\r\n              >\r\n                <option value=\"\">בחר מנוי</option>\r\n                {/* Replace this list dynamically */}\r\n                <option value=\"כרטיסייה\">כרטיסייה</option>\r\n                <option value=\"מנוי חודשי\">מנוי חודשי</option>\r\n              </select>\r\n              <div className=\"flex justify-end space-x-2 rtl:space-x-reverse\">\r\n                <button\r\n                  onClick={() => setIsPopupOpen(false)}\r\n                  className=\"px-4 py-2 bg-gray-500 text-white rounded-md\"\r\n                >\r\n                  ביטול\r\n                </button>\r\n                <button\r\n                  onClick={editingUser ? handleEditUser : handleAddUser}\r\n                  className=\"px-4 py-2 bg-green-500 text-white rounded-md\"\r\n                >\r\n                  {editingUser ? 'שמור שינויים' : 'הוסף'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserManagement;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { fetchCollection, addDocument, deleteDocument } from '../services/firebaseService';\r\n\r\nconst ManagerPage = () => {\r\n  const [lessonTypes, setLessonTypes] = useState([]);\r\n  const [newLessonType, setNewLessonType] = useState('');\r\n  const [memberships, setMemberships] = useState([]);\r\n  const [newMembership, setNewMembership] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  useEffect(() => {\r\n    fetchLessonTypes();\r\n    fetchMemberships();\r\n  }, []);\r\n\r\n  const fetchLessonTypes = async () => {\r\n    try {\r\n      const types = await fetchCollection('LessonTypes');\r\n      setLessonTypes(types);\r\n    } catch (error) {\r\n      handleError(error);\r\n    }\r\n  };\r\n\r\n  const fetchMemberships = async () => {\r\n    try {\r\n      const membershipsList = await fetchCollection('Memberships');\r\n      setMemberships(membershipsList);\r\n    } catch (error) {\r\n      handleError(error);\r\n    }\r\n  };\r\n\r\n  const handleError = (error) => {\r\n    console.error(error);\r\n    setError('אירעה שגיאה, נסו שוב מאוחר יותר.');\r\n  };\r\n\r\n  const handleAddLessonType = async () => {\r\n    if (!newLessonType.trim()) {\r\n      setError('שם סוג שיעור אינו יכול להיות ריק.');\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const newType = await addDocument('LessonTypes', { name: newLessonType.trim() });\r\n      setLessonTypes([...lessonTypes, newType]);\r\n      setNewLessonType('');\r\n    } catch (error) {\r\n      handleError(error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleAddMembership = async () => {\r\n    if (!newMembership.trim()) {\r\n      setError('שם מנוי אינו יכול להיות ריק.');\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const newMembershipData = await addDocument('Memberships', { name: newMembership.trim() });\r\n      setMemberships([...memberships, newMembershipData]);\r\n      setNewMembership('');\r\n    } catch (error) {\r\n      handleError(error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteLessonType = async (id) => {\r\n    setIsLoading(true);\r\n    try {\r\n      await deleteDocument('LessonTypes', id);\r\n      setLessonTypes(lessonTypes.filter((type) => type.id !== id));\r\n    } catch (error) {\r\n      handleError(error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteMembership = async (id) => {\r\n    setIsLoading(true);\r\n    try {\r\n      await deleteDocument('Memberships', id);\r\n      setMemberships(memberships.filter((membership) => membership.id !== id));\r\n    } catch (error) {\r\n      handleError(error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h1 className=\"text-2xl font-bold mb-4\">ניהול סוגי שיעורים ומנויים</h1>\r\n      {error && <div className=\"bg-red-100 text-red-700 p-4 rounded-lg mb-4\">{error}</div>}\r\n\r\n      {/* Lesson Types Management */}\r\n      <div className=\"mb-8\">\r\n        <h2 className=\"text-xl font-bold mb-4\">ניהול סוגי שיעורים</h2>\r\n        <input\r\n          type=\"text\"\r\n          value={newLessonType}\r\n          onChange={(e) => setNewLessonType(e.target.value)}\r\n          placeholder=\"הוסף סוג שיעור חדש\"\r\n          className=\"p-2 border rounded w-full\"\r\n        />\r\n        <button\r\n          onClick={handleAddLessonType}\r\n          disabled={isLoading || !newLessonType.trim()}\r\n          className={`bg-blue-500 text-white px-4 py-2 rounded mt-2 ${isLoading ? 'opacity-50' : ''}`}\r\n        >\r\n          {isLoading ? 'מוסיף...' : 'הוסף סוג שיעור'}\r\n        </button>\r\n        <EditableList items={lessonTypes} onDelete={handleDeleteLessonType} />\r\n      </div>\r\n\r\n      {/* Memberships Management */}\r\n      <div>\r\n        <h2 className=\"text-xl font-bold mb-4\">ניהול מנויים</h2>\r\n        <input\r\n          type=\"text\"\r\n          value={newMembership}\r\n          onChange={(e) => setNewMembership(e.target.value)}\r\n          placeholder=\"הוסף מנוי חדש\"\r\n          className=\"p-2 border rounded w-full\"\r\n        />\r\n        <button\r\n          onClick={handleAddMembership}\r\n          disabled={isLoading || !newMembership.trim()}\r\n          className={`bg-green-500 text-white px-4 py-2 rounded mt-2 ${isLoading ? 'opacity-50' : ''}`}\r\n        >\r\n          {isLoading ? 'מוסיף...' : 'הוסף מנוי'}\r\n        </button>\r\n        <EditableList items={memberships} onDelete={handleDeleteMembership} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// EditableList Component\r\nconst EditableList = ({ items, onDelete }) => (\r\n  <ul className=\"mt-4 space-y-2\">\r\n    {items.map((item) => (\r\n      <li key={item.id} className=\"flex justify-between items-center border p-2 rounded\">\r\n        <span>{item.name}</span>\r\n        <button\r\n          onClick={() => onDelete(item.id)}\r\n          className=\"text-red-500\"\r\n        >\r\n          מחק\r\n        </button>\r\n      </li>\r\n    ))}\r\n  </ul>\r\n);\r\n\r\nexport default ManagerPage;\r\n","import React, { useState } from 'react';\r\n\r\nconst getFileName = (filePath) => {\r\n  return filePath.split(/(\\\\|\\/)/).pop();\r\n};\r\n\r\nconst TestStatus = ({ passed, failed, total }) => (\r\n  <div className=\"grid grid-cols-3 gap-4 mb-6\">\r\n    <div className=\"bg-gray-50 p-4 rounded-lg text-center\">\r\n      <div className=\"text-lg font-bold\">{total}</div>\r\n      <div className=\"text-sm text-gray-600\">סה\"כ בדיקות</div>\r\n    </div>\r\n    <div className=\"bg-green-50 p-4 rounded-lg text-center\">\r\n      <div className=\"text-lg font-bold text-green-700\">{passed}</div>\r\n      <div className=\"text-sm text-green-600\">עברו</div>\r\n    </div>\r\n    <div className=\"bg-red-50 p-4 rounded-lg text-center\">\r\n      <div className=\"text-lg font-bold text-red-700\">{failed}</div>\r\n      <div className=\"text-sm text-red-600\">נכשלו</div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst TestSuite = ({ suite }) => {\r\n  const isPassed = suite.status === 'passed';\r\n  \r\n  return (\r\n    <div className=\"border rounded-lg p-4 mb-4\">\r\n      <div className=\"flex justify-between items-center mb-3\">\r\n        <h3 className=\"font-bold\">{getFileName(suite.name)}</h3>\r\n        <span className={`px-2 py-1 text-sm rounded-full ${\r\n          isPassed ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\r\n        }`}>\r\n          {isPassed ? 'עבר' : 'נכשל'}\r\n        </span>\r\n      </div>\r\n\r\n      {/* Test Details */}\r\n      {suite.assertionResults?.map((test, index) => (\r\n        <div \r\n          key={index}\r\n          className={`border-l-4 pl-3 py-2 mb-2 ${\r\n            test.status === 'passed' \r\n              ? 'border-green-500 bg-green-50' \r\n              : 'border-red-500 bg-red-50'\r\n          }`}\r\n        >\r\n          <div className=\"flex items-center\">\r\n            <div className={`w-3 h-3 rounded-full mr-2 ${\r\n              test.status === 'passed' ? 'bg-green-500' : 'bg-red-500'\r\n            }`} />\r\n            <span>{test.title}</span>\r\n          </div>\r\n          \r\n          {/* Show Error Message for Failed Tests */}\r\n          {test.status === 'failed' && test.failureMessages?.map((message, i) => (\r\n            <div key={i} className=\"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded\">\r\n              {message.split('\\n')[0]}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst TestsScreen = () => {\r\n  const [testResults, setTestResults] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const fetchTestResults = async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    setTestResults(null);\r\n\r\n    try {\r\n      const response = await fetch(process.env.REACT_APP_API_URL, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      const data = await response.json();\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(data.details || data.error || 'Server error occurred');\r\n      }\r\n\r\n      console.log('Received test results:', data);\r\n      setTestResults(data);\r\n    } catch (error) {\r\n      console.error('Test run error:', error);\r\n      setError(`Error running tests: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Calculate test statistics\r\n  const getTestStats = () => {\r\n    if (!testResults) return { total: 0, passed: 0, failed: 0 };\r\n\r\n    return {\r\n      total: testResults.numTotalTests || 0,\r\n      passed: testResults.numPassedTests || 0,\r\n      failed: testResults.numFailedTests || 0\r\n    };\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative min-h-screen\">\r\n      {/* Sticky Header */}\r\n      <div className=\"sticky top-0 bg-white shadow-md z-50 p-4 border-b\">\r\n        <div className=\"container mx-auto flex justify-between items-center\">\r\n          <h1 className=\"text-2xl font-bold\">ניהול בדיקות (Jest)</h1>\r\n          <button\r\n            onClick={fetchTestResults}\r\n            disabled={isLoading}\r\n            className={`px-4 py-2 rounded-lg ${\r\n              isLoading \r\n                ? 'bg-gray-400 cursor-not-allowed' \r\n                : 'bg-blue-500 hover:bg-blue-600'\r\n            } text-white transition-colors`}\r\n          >\r\n            {isLoading ? 'מריץ בדיקות...' : 'הרץ בדיקות'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n      <div className=\"container mx-auto p-4\">\r\n        {isLoading && (\r\n          <div className=\"flex justify-center items-center p-8\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\" />\r\n            <span className=\"mr-3\">טוען בדיקות...</span>\r\n          </div>\r\n        )}\r\n\r\n        {error && (\r\n          <div className=\"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6\">\r\n            <div className=\"flex\">\r\n              <div className=\"flex-shrink-0\">\r\n                <svg className=\"h-5 w-5 text-red-500\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\r\n                </svg>\r\n              </div>\r\n              <div className=\"mr-3\">\r\n                <p className=\"font-bold\">שגיאה בהרצת הבדיקות</p>\r\n                <p className=\"text-sm\">{error}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {!isLoading && !error && testResults && (\r\n          <div>\r\n            <TestStatus {...getTestStats()} />\r\n            \r\n            <div className=\"space-y-4\">\r\n              {testResults.testResults?.map((suite, index) => (\r\n                <TestSuite key={index} suite={suite} />\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {!isLoading && !error && !testResults && (\r\n          <div className=\"text-center text-gray-500 p-8\">\r\n            <p className=\"text-lg\">לחץ על \"הרץ בדיקות\" כדי להתחיל</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n    \r\n  );\r\n};\r\n\r\n\r\nexport default TestsScreen;","import React, { useState, useEffect } from 'react';\r\nimport { db } from '../firebase';\r\nimport { collection, getDocs, doc, setDoc, getDoc } from 'firebase/firestore';\r\nimport { useLogo } from '../contexts/LogoContext';\r\nimport moment from 'moment';\r\nimport { Line, Pie, Bar } from 'react-chartjs-2';\r\nimport LessonManagement from './LessonManagement';\r\nimport UserManagement from './UserManagement';\r\nimport ManagerPage from './ManagerPage';\r\nimport TestsScreen from './TestsScreen'; // New Import\r\n\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  BarElement,\r\n  ArcElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n} from 'chart.js';\r\n\r\n// Register ChartJS components\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  BarElement,\r\n  ArcElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n);\r\n\r\n// Helper function to detect screen size\r\nconst useIsMobile = () => {\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth <= 768);\r\n\r\n  useEffect(() => {\r\n    const handleResize = () => setIsMobile(window.innerWidth <= 768);\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  return isMobile;\r\n};\r\n\r\nconst chartOptions = {\r\n  responsive: true,\r\n  plugins: {\r\n    legend: {\r\n      position: 'top',\r\n    },\r\n  },\r\n};\r\n\r\nconst AdminDashboard = ({ setCurrentScreen }) => {\r\n  const [stats, setStats] = useState(null);\r\n  const [chartData, setChartData] = useState(null);\r\n  const [pieChartData, setPieChartData] = useState(null);\r\n  const [barChartData, setBarChartData] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const { setLogoUrl } = useLogo();\r\n  const [activeSection, setActiveSection] = useState('dashboard');\r\n  const [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n\r\n  const isMobile = useIsMobile();\r\n\r\n  useEffect(() => {\r\n    loadStats();\r\n    loadChartData();\r\n    loadPieChartData();\r\n    loadBarChartData();\r\n    fetchLogo();\r\n  }, []);\r\n\r\n  const loadStats = async () => {\r\n    try {\r\n      const lessonsSnapshot = await getDocs(collection(db, 'Lessons'));\r\n      const lessons = lessonsSnapshot.docs.map((doc) => doc.data());\r\n\r\n      const currentWeekStart = moment().startOf('week');\r\n      const currentMonthStart = moment().startOf('month');\r\n\r\n      let weeklyRegistrations = 0;\r\n      let monthlyRegistrations = 0;\r\n      let activeLessons = 0;\r\n\r\n      lessons.forEach((lesson) => {\r\n        const lessonDateTime = moment(\r\n          `${lesson.date} ${lesson.time}`,\r\n          'YYYY-MM-DD HH:mm',\r\n        );\r\n        if (lessonDateTime.isSameOrAfter(currentWeekStart)) {\r\n          weeklyRegistrations += lesson.registeredParticipants || 0;\r\n        }\r\n        if (lessonDateTime.isSameOrAfter(currentMonthStart)) {\r\n          monthlyRegistrations += lesson.registeredParticipants || 0;\r\n        }\r\n        if (lesson.isActive) {\r\n          activeLessons++;\r\n        }\r\n      });\r\n\r\n      setStats({\r\n        activeLessons,\r\n        weeklyRegistrations,\r\n        monthlyRegistrations,\r\n      });\r\n    } catch (error) {\r\n      console.error('Error loading stats:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadChartData = async () => {\r\n    try {\r\n      const lessonsSnapshot = await getDocs(collection(db, 'Lessons'));\r\n      const lessons = lessonsSnapshot.docs.map((doc) => doc.data());\r\n\r\n      const monthlyData = {};\r\n      const lastFourMonths = [...Array(4)]\r\n        .map((_, i) => moment().subtract(i, 'months').format('MMMM'))\r\n        .reverse();\r\n\r\n      lastFourMonths.forEach((month) => (monthlyData[month] = 0));\r\n\r\n      lessons.forEach((lesson) => {\r\n        const monthName = moment(lesson.date, 'YYYY-MM-DD').format('MMMM');\r\n        if (monthlyData[monthName] !== undefined) {\r\n          monthlyData[monthName] += lesson.registeredParticipants || 0;\r\n        }\r\n      });\r\n\r\n      setChartData({\r\n        labels: Object.keys(monthlyData),\r\n        datasets: [\r\n          {\r\n            label: 'הרשמות חודשיות',\r\n            data: Object.values(monthlyData),\r\n            borderColor: 'rgb(75, 192, 192)',\r\n            backgroundColor: 'rgba(75, 192, 192, 0.5)',\r\n            tension: 0.1,\r\n          },\r\n        ],\r\n      });\r\n    } catch (error) {\r\n      console.error('Error loading chart data:', error);\r\n    }\r\n  };\r\n\r\n  const loadPieChartData = async () => {\r\n    try {\r\n      const usersSnapshot = await getDocs(collection(db, 'Users'));\r\n      const users = usersSnapshot.docs.map((doc) => doc.data());\r\n\r\n      const membershipData = users.reduce((acc, user) => {\r\n        const type = user.type || user.subscriptionType || user.membershipType;\r\n        if (type) {\r\n          acc[type] = (acc[type] || 0) + 1;\r\n        }\r\n        return acc;\r\n      }, {});\r\n\r\n      setPieChartData({\r\n        labels: Object.keys(membershipData),\r\n        datasets: [\r\n          {\r\n            label: 'סוגי מנויים',\r\n            data: Object.values(membershipData),\r\n            backgroundColor: [\r\n              'rgba(255, 99, 132, 0.6)',\r\n              'rgba(54, 162, 235, 0.6)',\r\n              'rgba(255, 206, 86, 0.6)',\r\n              'rgba(75, 192, 192, 0.6)',\r\n              'rgba(153, 102, 255, 0.6)',\r\n            ],\r\n            borderWidth: 1,\r\n          },\r\n        ],\r\n      });\r\n    } catch (error) {\r\n      console.error('Error loading pie chart data:', error);\r\n    }\r\n  };\r\n\r\n  const loadBarChartData = async () => {\r\n    try {\r\n      const usersSnapshot = await getDocs(collection(db, 'Users'));\r\n      const users = usersSnapshot.docs.map((doc) => doc.data());\r\n\r\n      const monthlyData = {};\r\n      const lastFourMonths = [...Array(4)]\r\n        .map((_, i) => moment().subtract(i, 'months').format('MMMM'))\r\n        .reverse();\r\n\r\n      lastFourMonths.forEach((month) => (monthlyData[month] = 0));\r\n\r\n      users.forEach((user) => {\r\n        const monthName = moment(user.joinDate, 'YYYY-MM-DD').format('MMMM');\r\n        if (monthlyData[monthName] !== undefined) {\r\n          monthlyData[monthName]++;\r\n        }\r\n      });\r\n\r\n      setBarChartData({\r\n        labels: Object.keys(monthlyData),\r\n        datasets: [\r\n          {\r\n            label: 'משתמשים חדשים',\r\n            data: Object.values(monthlyData),\r\n            backgroundColor: 'rgba(54, 162, 235, 0.6)',\r\n          },\r\n        ],\r\n      });\r\n    } catch (error) {\r\n      console.error('Error loading bar chart data:', error);\r\n    }\r\n  };\r\n\r\n  const fetchLogo = async () => {\r\n    try {\r\n      const settingsRef = doc(db, 'StudioInfo', 'Logo');\r\n      const logoDoc = await getDoc(settingsRef);\r\n\r\n      if (logoDoc.exists()) {\r\n        setLogoUrl(logoDoc.data()?.logoBase64);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching logo:', error);\r\n    }\r\n  };\r\n\r\n  const handleLogoUpload = async (event) => {\r\n    const file = event.target.files[0];\r\n    if (!file) return;\r\n\r\n    try {\r\n      const reader = new FileReader();\r\n      reader.onloadend = async () => {\r\n        const base64Logo = reader.result;\r\n        const settingsRef = doc(db, 'StudioInfo', 'Logo');\r\n        await setDoc(settingsRef, { logoBase64: base64Logo });\r\n\r\n        setLogoUrl(base64Logo);\r\n      };\r\n      reader.readAsDataURL(file);\r\n    } catch (error) {\r\n      console.error('Error uploading logo:', error);\r\n      alert('אירעה שגיאה בהעלאת הלוגו');\r\n    }\r\n  };\r\n\r\n  const menuItems = [\r\n    { id: 'dashboard', label: 'לוח בקרה', icon: '📊' },\r\n    { id: 'users', label: 'ניהול משתמשים', icon: '👥' },\r\n    { id: 'lessons', label: 'ניהול שיעורים', icon: '📅' },\r\n    { id: 'manager', label: 'ניהול מנהלים', icon: '⚙️' },\r\n    { id: 'tests', label: 'ניהול בדיקות (Jest)', icon: '🧪' }, // New Menu Item\r\n  ];\r\n  const renderContent = () => {\r\n    switch (activeSection) {\r\n      case 'dashboard':\r\n        return (\r\n          \r\n          <div className=\"space-y-3\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n              <div className=\"bg-white rounded-lg p-6 shadow-sm\">\r\n                <h2 className=\"text-xl font-bold mb-4\">סטטיסטיקות מהירות</h2>\r\n                {isLoading ? (\r\n                  <div className=\"animate-pulse space-y-4\">\r\n                    <div className=\"h- bg-gray-200 rounded\"></div>\r\n                    <div className=\"h-25 bg-gray-200 rounded\"></div>\r\n                    <div className=\"h-25 bg-gray-200 rounded\"></div>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\r\n                      <span className=\"text-gray-600\">שיעורים פעילים</span>\r\n                      <span className=\"font-semibold\">{stats?.activeLessons || 0}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\r\n                      <span className=\"text-gray-600\">נרשמים השבוע</span>\r\n                      <span className=\"font-semibold\">{stats?.weeklyRegistrations || 0}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\r\n                      <span className=\"text-gray-600\">נרשמים החודש</span>\r\n                      <span className=\"font-semibold\">{stats?.monthlyRegistrations || 0}</span>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"bg-white rounded-lg p-2 shadow-sm\">\r\n              <div className=\"bg-white rounded-lg p-2 shadow-sm\">\r\n                <h2 className=\"text-xl font-bold mb-1\">העלאת לוגו</h2>\r\n                <input\r\n                  type=\"file\"\r\n                  onChange={handleLogoUpload}\r\n                  accept=\"image/*\"\r\n                  className=\"file:mr-4 file:py-2 file:px-4\r\n                  file:rounded-full file:border-0\r\n                  file:text-sm file:font-semibold\r\n                  file:bg-blue-50 file:text-blue-700\r\n                  hover:file:bg-blue-100\"\r\n                />\r\n              </div>\r\n                <h2 className=\"text-xl font-bold mb-2\">מגמת הרשמות</h2>\r\n                <div className=\"w-full\">\r\n                  {chartData && <Line data={chartData} options={chartOptions} />}\r\n                </div>\r\n              </div>\r\n              <div className=\"bg-white rounded-lg p-1 shadow-sm\">\r\n                <h2 className=\"text-xl font-bold mb-1\">התפלגות סוגי מנויים</h2>\r\n                <div className=\"h-64 w-64 mx-auto\">\r\n                  {pieChartData && <Pie data={pieChartData} options={chartOptions} />}\r\n                </div>\r\n              </div>\r\n              <div className=\"bg-white rounded-lg p-6 shadow-sm\">\r\n                <h2 className=\"text-xl font-bold mb-4\">משתמשים חדשים</h2>\r\n                <div className=\"h-full w-full mx-auto\">\r\n                  {barChartData && <Bar data={barChartData} options={chartOptions} />}\r\n                </div>\r\n              </div>\r\n             \r\n              </div>\r\n          </div>\r\n        );\r\n      case 'users':\r\n        return <UserManagement />;\r\n      case 'lessons':\r\n        return <LessonManagement />;\r\n        case 'manager':\r\n          return <ManagerPage />;\r\n        case 'tests': // New Route\r\n          return <TestsScreen />;\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col md:flex-row\">\r\n      {/* Sidebar / Navigation */}\r\n      <div className=\"bg-white shadow-lg md:w-1/4 w-full md:block\">\r\n        <div className=\"p-4 border-b\">\r\n          <h1 className=\"text-xl font-bold\">ניהול מערכת</h1>\r\n        </div>\r\n\r\n        {isMobile ? (\r\n          // Mobile Dropdown Menu\r\n          <div className=\"relative\">\r\n            <button\r\n              onClick={() => setIsDropdownOpen(!isDropdownOpen)}\r\n              className=\"flex items-center p-3 mx-auto w-full text-gray-600 bg-gray-50 rounded-lg shadow-md md:hidden\"\r\n            >\r\n              תפריט\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                className={`h-5 w-5 ml-2 transition-transform ${\r\n                  isDropdownOpen ? 'rotate-180' : ''\r\n                }`}\r\n                fill=\"none\"\r\n                viewBox=\"0 0 24 24\"\r\n                stroke=\"currentColor\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M19 9l-7 7-7-7\"\r\n                />\r\n              </svg>\r\n            </button>\r\n            {isDropdownOpen && (\r\n              <div className=\"absolute w-full bg-white shadow-lg z-10 rounded-lg\">\r\n                {menuItems.map((item) => (\r\n                  <button\r\n                    key={item.id}\r\n                    onClick={() => {\r\n                      setActiveSection(item.id);\r\n                      setIsDropdownOpen(false); // Close dropdown on selection\r\n                    }}\r\n                    className={`flex items-center p-3 w-full text-left ${\r\n                      activeSection === item.id\r\n                        ? 'bg-blue-50 text-blue-700'\r\n                        : 'text-gray-600 hover:bg-gray-50'\r\n                    }`}\r\n                  >\r\n                    <span className=\"mr-3\">{item.icon}</span>\r\n                    {item.label}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          // Desktop Menu\r\n          <nav className=\"p-4 flex flex-col hidden md:block\">\r\n            {menuItems.map((item) => (\r\n              <button\r\n                key={item.id}\r\n                onClick={() => setActiveSection(item.id)}\r\n                className={`flex items-center p-3 rounded-lg transition-colors ${\r\n                  activeSection === item.id\r\n                    ? 'bg-blue-50 text-blue-700'\r\n                    : 'text-gray-600 hover:bg-gray-50'\r\n                }`}\r\n              >\r\n                <span className=\"mr-3\">{item.icon}</span>\r\n                {item.label}\r\n              </button>\r\n            ))}\r\n          </nav>\r\n        )}\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"flex-1 p-8 overflow-auto\">{renderContent()}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminDashboard;\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { useUser } from '../contexts/UserContext';\r\nimport { useLogo } from '../contexts/LogoContext';\r\n\r\nconst TopNav = ({ setCurrentScreen, currentScreen, handleLogout }) => {\r\n  const { logoUrl } = useLogo();\r\n  const { userData } = useUser();\r\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n  const menuRef = useRef(null);\r\n\r\n  // סגירת התפריט בלחיצה מחוץ לתפריט\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n        setIsMenuOpen(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  const menuItems = [\r\n    { id: 'home', label: 'דף הבית', icon: '🏠' },\r\n    { id: 'schedule', label: 'לוח שיעורים', icon: '📅' },\r\n    { id: 'profile', label: 'פרופיל', icon: '👤' },\r\n  ];\r\n\r\n  if (userData?.isAdmin) {\r\n    menuItems.push({ id: 'admin', label: 'ניהול', icon: '⚙️' });\r\n  }\r\n\r\n  const handleMenuItemClick = (itemId) => {\r\n    setCurrentScreen(itemId);\r\n    setIsMenuOpen(false);\r\n  };\r\n\r\n  return (\r\n    <nav className=\"bg-white shadow-sm\">\r\n      <div className=\"max-w-7xl mx-auto px-4\">\r\n        <div className=\"flex justify-between items-center h-25\">\r\n          {/* Logo Section */}\r\n          <div className=\"flex-shrink-0 flex items-center\">\r\n            <img\r\n              src={logoUrl}\r\n              className=\"w-32 h-32 object-contain\"\r\n              alt=\"Milan Pilates\"\r\n            />\r\n            <span className=\"mr-2 text-lg font-semibold text-gray-900\">\r\n              Milan Pilates\r\n            </span>\r\n          </div>\r\n\r\n          {/* Menu Section */}\r\n          <div className=\"relative\" ref={menuRef}>\r\n            {/* Menu Button */}\r\n            <button\r\n              onClick={() => setIsMenuOpen(!isMenuOpen)}\r\n              className=\"flex items-center px-4 py-2 rounded-md text-gray-600 hover:bg-gray-50 focus:outline-none\"\r\n            >\r\n              <span className=\"text-xl\">{isMenuOpen ? '✕' : '☰'}</span>\r\n              <span className=\"mr-2 text-sm font-medium\">תפריט</span>\r\n            </button>\r\n\r\n            {/* Dropdown Menu */}\r\n            {isMenuOpen && (\r\n              <div className=\"absolute left-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50\">\r\n                <div className=\"py-1\">\r\n                  {menuItems.map((item) => (\r\n                    <button\r\n                      key={item.id}\r\n                      onClick={() => handleMenuItemClick(item.id)}\r\n                      className={`w-full text-right flex items-center px-4 py-2 text-sm\r\n                        ${currentScreen === item.id\r\n                          ? 'bg-blue-50 text-blue-700'\r\n                          : 'text-gray-700 hover:bg-gray-50'\r\n                        }`}\r\n                    >\r\n                      <span className=\"ml-2\">{item.icon}</span>\r\n                      {item.label}\r\n                    </button>\r\n                  ))}\r\n                  <div className=\"border-t border-gray-100\"></div>\r\n                  <button\r\n                    onClick={() => {\r\n                      handleLogout();\r\n                      setIsMenuOpen(false);\r\n                    }}\r\n                    className=\"w-full text-right flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50\"\r\n                  >\r\n                    <span className=\"ml-2\">🚪</span>\r\n                    התנתקות\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  );\r\n};\r\n\r\nexport default TopNav;","import React, { useState, useEffect } from 'react';\nimport ReactDOM from 'react-dom/client';\n\nimport { UserProvider, useUser } from './contexts/UserContext';\nimport LoginForm from './pages/LoginForm';\nimport Home from './pages/Home';\nimport Schedule from './pages/Schedule';\nimport ProfileScreen from './pages/ProfileScreen';\nimport AdminDashboard from './pages/AdminDashboard';\nimport UserManagement from './pages/UserManagement';\nimport LessonManagement from './pages/LessonManagement';\nimport TopNav from './components/TopNav';\nimport './index.css';\n\n\n\n\nconst AppContent = () => {\n  const [currentScreen, setCurrentScreen] = useState('login');\n  const { isLoggedIn, userData, logout } = useUser();\n  const [menuOpen, setMenuOpen] = useState(false);\n  const [registeredUsers, setRegisteredUsers] = useState([]);\n\n  const addUser = (user) => {\n    setRegisteredUsers([...registeredUsers, user]);\n  };\n\n  const deleteUser = (phone) => {\n    setRegisteredUsers(registeredUsers.filter(user => user.phone !== phone));\n  };\n\n  const screenComponents = {\n    home: <Home user={userData} lessons={userData?.registeredLessons || []} />,\n    schedule: <Schedule />,\n    profile: <ProfileScreen />,\n    admin: userData?.isAdmin ? <AdminDashboard setCurrentScreen={setCurrentScreen} /> : null,\n    lessons: userData?.isAdmin ? <LessonManagement /> : null,\n    users: userData?.isAdmin ? <UserManagement registeredUsers={registeredUsers} addUser={addUser} deleteUser={deleteUser} /> : null,\n    settings: userData?.isAdmin ? <AdminDashboard setCurrentScreen={setCurrentScreen} activeTab=\"settings\" /> : null,\n  };\n\n  useEffect(() => {\n    console.log('המסך הנוכחי:', currentScreen);\n    console.log('isLoggedIn:', isLoggedIn);\n    console.log('userData:', userData);\n  }, [currentScreen, isLoggedIn, userData]);\n\n  return (\n    <div className=\"relative min-h-screen bg-gray-100\" dir=\"rtl\">\n      {isLoggedIn && (\n        <TopNav\n          setCurrentScreen={setCurrentScreen}\n          currentScreen={currentScreen}\n          handleLogout={logout}\n          userData={userData}\n          menuOpen={menuOpen}\n          setMenuOpen={setMenuOpen}\n        />\n      )}\n\n      {menuOpen && isLoggedIn && (\n        <div className=\"fixed inset-0 bg-gray-800 bg-opacity-75 z-50 md:hidden\">\n          <div className=\"fixed inset-y-0 right-0 w-64 bg-white shadow-lg p-4\">\n            <button\n              onClick={() => setMenuOpen(false)}\n              className=\"absolute top-4 right-4 text-gray-800 text-xl\"\n            >\n              ✕\n            </button>\n            <div className=\"mt-12 space-y-4\">\n              <button\n                onClick={() => {\n                  setCurrentScreen('home');\n                  setMenuOpen(false);\n                }}\n                className=\"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg\"\n              >\n                דף הבית\n              </button>\n              <button\n                onClick={() => {\n                  setCurrentScreen('schedule');\n                  setMenuOpen(false);\n                }}\n                className=\"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg\"\n              >\n                לוח שיעורים\n              </button>\n              <button\n                onClick={() => {\n                  setCurrentScreen('profile');\n                  setMenuOpen(false);\n                }}\n                className=\"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg\"\n              >\n                פרופיל\n              </button>\n              {userData?.isAdmin && (\n                <>\n                  <button\n                    onClick={() => {\n                      setCurrentScreen('admin');\n                      setMenuOpen(false);\n                    }}\n                    className=\"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg\"\n                  >\n                    ניהול\n                  </button>\n                  <button\n                    onClick={() => {\n                      setCurrentScreen('users');\n                      setMenuOpen(false);\n                    }}\n                    className=\"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg\"\n                  >\n                    ניהול משתמשים\n                  </button>\n                  <button\n                    onClick={() => {\n                      setCurrentScreen('lessons');\n                      setMenuOpen(false);\n                    }}\n                    className=\"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg\"\n                  >\n                    ניהול שיעורים\n                  </button>\n                  <button\n                    onClick={() => {\n                      setCurrentScreen('settings');\n                      setMenuOpen(false);\n                    }}\n                    className=\"w-full text-right px-4 py-2 text-sm hover:bg-gray-100 rounded-lg\"\n                  >\n                    הגדרות\n                  </button>\n                </>\n              )}\n              <button\n                onClick={logout}\n                className=\"w-full text-right px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg\"\n              >\n                התנתק\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <main className=\"container mx-auto p-4\">\n        {!isLoggedIn ? (\n          <LoginForm setCurrentScreen={setCurrentScreen} />\n        ) : (\n          screenComponents[currentScreen] || <Home />\n        )}\n      </main>\n    </div>\n  );\n};\n\nconst App = () => {\n  return (\n    <UserProvider>\n      <AppContent />\n    </UserProvider>\n  );\n};\n\nexport default App;","import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport App from \"./App\";\nimport { LogoProvider } from \"./contexts/LogoContext\";\nimport { UserProvider } from \"./contexts/UserContext\";\nimport \"./index.css\";\n\nconst root = ReactDOM.createRoot(document.getElementById(\"root\"));\nroot.render(\n  <React.StrictMode>\n    <UserProvider>\n      <LogoProvider> {/* Ensure LogoProvider wraps the entire app */}\n        <App />\n      </LogoProvider>\n    </UserProvider>\n  </React.StrictMode>\n);"],"sourceRoot":""}